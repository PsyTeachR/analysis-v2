<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Chapter 3 Data Visualisation Through ggplot2 | Analysis</title>
<meta name="author" content="Phil McAleer, Carolina E. Kuepper-Tetzel, Helena Paterson">
<meta name="description" content="3.1 Overview Data visualisation is very important for understanding your data. It is a key part of data analysis in exploring data, checking assumptions, and displaying results. Figures and plots...">
<meta name="generator" content="bookdown 0.24 with bs4_book()">
<meta property="og:title" content="Chapter 3 Data Visualisation Through ggplot2 | Analysis">
<meta property="og:type" content="book">
<meta property="og:url" content="https://psyteachr.github.io/analysis-v2/data-visualisation-through-ggplot2.html">
<meta property="og:image" content="https://psyteachr.github.io/analysis-v2/images/logos/logo.png">
<meta property="og:description" content="3.1 Overview Data visualisation is very important for understanding your data. It is a key part of data analysis in exploring data, checking assumptions, and displaying results. Figures and plots...">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Chapter 3 Data Visualisation Through ggplot2 | Analysis">
<meta name="twitter:description" content="3.1 Overview Data visualisation is very important for understanding your data. It is a key part of data analysis in exploring data, checking assumptions, and displaying results. Figures and plots...">
<meta name="twitter:image" content="https://psyteachr.github.io/analysis-v2/images/logos/logo.png">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/header-attrs-2.11/header-attrs.js"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.3.1/transition.js"></script><script src="libs/bs3compat-0.3.1/tabs.js"></script><script src="libs/bs3compat-0.3.1/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="libs/kePrint-0.0.1/kePrint.js"></script><link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet">
<!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=G-6NP3MF25W3"></script><script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'G-6NP3MF25W3');
    </script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS --><link rel="stylesheet" href="include/psyteachr.css">
<link rel="stylesheet" href="include/webex.css">
<link rel="stylesheet" href="include/style.css">
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">Analysis</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html">Overview</a></li>
<li><a class="" href="starting-with-r-markdown.html"><span class="header-section-number">1</span> Starting with R Markdown</a></li>
<li><a class="" href="data-wrangling-a-key-skill.html"><span class="header-section-number">2</span> Data-Wrangling: A Key Skill</a></li>
<li><a class="active" href="data-visualisation-through-ggplot2.html"><span class="header-section-number">3</span> Data Visualisation Through ggplot2</a></li>
<li><a class="" href="revisiting-probability-distributions.html"><span class="header-section-number">4</span> Revisiting Probability Distributions</a></li>
<li><a class="" href="nhst-binomial-test-and-one-sample-t-test.html"><span class="header-section-number">5</span> NHST: Binomial test and One-Sample t-test</a></li>
<li><a class="" href="nhst-two-sample-t-test.html"><span class="header-section-number">6</span> NHST: Two-Sample t-test</a></li>
<li><a class="" href="nhst-paired-sample-t-test-and-nonparametric-tests.html"><span class="header-section-number">7</span> NHST: Paired-Sample t-test and Nonparametric tests</a></li>
<li><a class="" href="apes---alpha-power-effect-sizes-sample-size.html"><span class="header-section-number">8</span> APES - Alpha, Power, Effect Sizes, Sample Size</a></li>
<li><a class="" href="correlations.html"><span class="header-section-number">9</span> Correlations</a></li>
<li><a class="" href="simple-regression.html"><span class="header-section-number">10</span> Simple Regression</a></li>
<li><a class="" href="multiple-regression.html"><span class="header-section-number">11</span> Multiple regression</a></li>
<li class="book-part">Appendices</li>
<li><a class="" href="acknowledgements.html">Acknowledgements</a></li>
<li><a class="" href="installing-r.html"><span class="header-section-number">A</span> Installing R</a></li>
<li><a class="" href="updating-r-rstudio-and-packages.html"><span class="header-section-number">B</span> Updating R, RStudio, and packages</a></li>
<li><a class="" href="exporting-files-from-the-server.html"><span class="header-section-number">C</span> Exporting files from the server</a></li>
<li><a class="" href="symbols.html"><span class="header-section-number">D</span> Symbols</a></li>
<li><a class="" href="license.html">License</a></li>
<li><a class="" href="references.html">References</a></li>
</ul>

        <div class="book-extra">
          <p><a id="book-repo" href="https://github.com/psyteachr/analysis-v2">View book source <i class="fab fa-github"></i></a></p>
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="data-visualisation-through-ggplot2" class="section level1" number="3">
<h1>
<span class="header-section-number">3</span> Data Visualisation Through <strong><code>ggplot2</code></strong><a class="anchor" aria-label="anchor" href="#data-visualisation-through-ggplot2"><i class="fas fa-link"></i></a>
</h1>
<div id="overview-3" class="section level2" number="3.1">
<h2>
<span class="header-section-number">3.1</span> Overview<a class="anchor" aria-label="anchor" href="#overview-3"><i class="fas fa-link"></i></a>
</h2>
<p>Data visualisation is very important for understanding your data. It is a key part of data analysis in exploring data, checking assumptions, and displaying results. Figures and plots allow you to get insight into patterns in your data. For example, in regards to seeing differences between groups, but also for seeing where things don't quite match up with what you think should be happening. A great example of this is Anscombe's Quartet, which you can read up about at a later date if you like - <a href="https://en.wikipedia.org/wiki/Anscombe%27s_quartet" target="_blank">see here</a> - four datasets given exact same means, but with very different underlying structures when visualised. The key point is that it is always good to visualise your data and visualisation should be a common step in your data skills set.</p>
<p>In the PsyTeachR <a href="https://psyteachr.github.io/" target="_blank">Data Skills book</a> we introduced data visualisation using <code>ggplot2</code>, the main visualisation package of <code>tidyverse</code>. You should look back at that when working through this chapter, and you can find additional info here at the main page for the package: <a href="https://ggplot2.tidyverse.org/" target="_blank">ggplot2</a>.</p>
<p>For visualisaion we use <code>ggplot2</code> and below we have listed some great online resources that you might want to consult if you want a fuller understanding:</p>
<ul>
<li><a href="http://www.cookbook-r.com/Graphs/" target="_blank">R Graphics Cookbook</a></li>
<li><a href="https://ggplot2-book.org/" target="_blank">ggplot2 book</a></li>
<li><a href="https://www.rstudio.com/wp-content/uploads/2015/03/ggplot2-cheatsheet.pdf" target="_blank">ggplot2 cheatsheet</a></li>
<li><a href="http://ggplot2.tidyverse.org/reference/" target="_blank">ggplot2 Reference Guide</a></li>
</ul>
<p>In this chapter, we will revisit plotting data and expand your skills in order to make effective and informative figures. This will become really beneficial to you as your progress because data visualisation is a skill that applies to multiple careers, not just Psychology.</p>
<p>In this chapter you will:</p>
<ol style="list-style-type: decimal">
<li>Recap on data visualisation</li>
<li>Expand your skills to produce new figures</li>
<li>Learn about Mental Rotation research</li>
</ol>
</div>
<div id="data-visualisation-basics" class="section level2" number="3.2">
<h2>
<span class="header-section-number">3.2</span> Data Visualisation Basics<a class="anchor" aria-label="anchor" href="#data-visualisation-basics"><i class="fas fa-link"></i></a>
</h2>
<div id="introducing-the-data-set-mental-rotation-ability" class="section level3" number="3.2.1">
<h3>
<span class="header-section-number">3.2.1</span> Introducing the Data Set: Mental Rotation Ability<a class="anchor" aria-label="anchor" href="#introducing-the-data-set-mental-rotation-ability"><i class="fas fa-link"></i></a>
</h3>
<p>The data we will use today comes from a replication of a classic experiment merging the fields of Perception and Cognition. <a href="http://science.sciencemag.org/content/171/3972/701" target="_blank">Shepard and Metzler (1971)</a> demonstrated that when participants were shown two similar three-dimensional shapes, one just a rotated version of the other (see the figure below - top panel), and asked whether they were the same shape or not, the reaction time and error rates of responses were a function of rotation; i.e. the larger the difference in rotation between the two shapes, the longer it took participants to say "same" or "different", and the more errors they made.</p>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:img-rotation-task"></span>
<img src="images/s01-lab03/preclass/13-113-1-PB.jpg" alt="The Mental Rotation Task as shown in Ganis and Kievit (2016) Figure 1" width="50%"><p class="caption">
Figure 3.1: The Mental Rotation Task as shown in Ganis and Kievit (2016) Figure 1
</p>
</div>
<p>The image shown in Figure <a href="data-visualisation-through-ggplot2.html#fig:img-rotation-task">3.1</a> actually comes from the replication by <a href="https://openpsychologydata.metajnl.com/articles/10.5334/jopd.ai/" target="_blank">Ganis and Kievit (2016)</a>. In the top panel the two shapes are the same but the shape on the right is rotated vertically at 150 degrees from the original (the left shape) and so participants should respond "same". In the bottom panel, however, the two shapes are different; the one on the right is again rotated at 150 degrees, but in this trial it takes longer for participants to realise that they are different shapes.</p>
<p>You can read more about Ganis and Kievit (2016) in your own time, but the basic methods are that they ran 54 participants on a series of these images using four angles of rotation (0, 50, 100, 150 degrees) and asked people to respond 'same' or 'different' on each trial. The data can be <a href="data/03-s01/preclass/ch3-preclass-data.zip">downloaded from here</a>. You should use this data to follow along below and try to answer the questions.</p>
<p><strong>Look at the data</strong></p>
<ol style="list-style-type: decimal">
<li>Download the data folder, unzip it, and save it to a folder you have access to.</li>
<li>Set your working directory to that folder <strong><code>Session &gt;&gt; Set Working Directory &gt;&gt; Choose Directory</code></strong>
</li>
<li>Open a new Rscript or .RMarkdown file and save it within the folder that contains the data, giving the script a sensible name, e.g. <code>Chapter3_visualisations.R</code>. If you prefer to work in RMarkdown, just remember you will need to embed code into code chunks, as shown in Chapter 1.</li>
<li>Copy the three code lines below into your script and run them to bring <code>tidyverse</code> into the library and to read in the two data files.</li>
</ol>
<div class="sourceCode" id="cb87"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="st"><a href="https://tidyverse.tidyverse.org">"tidyverse"</a></span><span class="op">)</span>

<span class="va">menrot</span> <span class="op">&lt;-</span> <span class="fu">read_csv</span><span class="op">(</span><span class="st">"MentalRotationBehavioralData.csv"</span><span class="op">)</span>
<span class="va">demog</span> <span class="op">&lt;-</span> <span class="fu">read_csv</span><span class="op">(</span><span class="st">"demographics.csv"</span><span class="op">)</span></code></pre></div>
<ul>
<li>Note, there is no difference between <code><a href="https://tidyverse.tidyverse.org">library(tidyverse)</a></code> and <code><a href="https://tidyverse.tidyverse.org">library("tidyverse")</a></code> both will work.</li>
<li>However, there is a difference between <code>demog &lt;- read_csv("demographics.csv")</code> and <code>demog &lt;- read_csv(demographics.csv)</code>. You will need quotes around the .csv file name as shown in the code chunk above (e.g. <code>demog &lt;- read_csv("demographics.csv")</code>), or the code won't work.</li>
</ul>
<div class="webex-solution">
<button>
Explain this - Why load tidyverse and not just ggplot2?
</button>
<div class="info">
<p>
This is a really great question as we always seem to be saying to use <code>dplyr</code> or <code>readr</code> or <code>ggplot</code>, but we never actually call them in. Remember, however, that <code>tidyverse</code> is actually a <strong>collection of packages</strong>, the most common packages in fact, and we use it to bring in these common packages (including <code>ggplot2</code>) because you will probably need the other packages along with it for the codes to run smoothly. We will try to tell you when you need to call other packages alongside <code>tidyverse</code>, but do keep in mind that most of your codes will at least start with the <code>tidyverse</code> package.
</p>
<p>
Small point, if looking for help on <code>ggplot</code>, the package is actually called <code>ggplot2</code>. This is the newer version of the package, so search <code>ggplot2</code> if you need help.
</p>
</div>
</div>
<p><br>
Let's start by having a look at the data we have brought in. You can do this whichever way you choose; we mentioned three ways in the previous chapter.</p>
<p>First, <code>demog</code> - short for demographics. It has three columns:</p>
<ul>
<li>Participant - the ID of the participant</li>
<li>Age - the age of the participant</li>
<li>Sex - the sex of the participant</li>
</ul>
<p>Secondly, <code>menrot</code> - short for mental rotation. It has 8 columns:</p>
<ul>
<li>Participant - the ID of the participant; matches with ID in <code>demog</code>
</li>
<li>Trial - the trial number in the experiment for each participant</li>
<li>Condition - the name of the image shown; <strong>R</strong> indicates the rotated image was different</li>
<li>Time - the reaction time to respond on each trial in milliseconds</li>
<li>DesiredResponse - what participants should have responded on each trial; <strong>Different</strong> or <strong>Same</strong>
</li>
<li>ActualResponse - what participants did respond on each trial; <strong>Different</strong> or <strong>Same</strong>
</li>
<li>Angle - the angle that the shape on the right was rotated compared to the shape on the left (0, 50, 100, 150)</li>
<li>CorrectResponse - whether the participant was <strong>correct</strong> or <strong>incorrect</strong> on a given trial</li>
</ul>
<div class="webex-solution">
<button>
Portfolio Point - Procedure sections in papers
</button>
<div class="info">
<p>
Ganis and Kievit (2016) is a very short paper that is really to introduce the stimuli set rather than give an extensive background on the topic of mental rotation - we call this a 'methods paper'. That said, the writing of the paper is very clear and the procedure is well detailed as to how they ran the actual experiment.
</p>
<p>
When writing a procedure, remember to give as much information as needed to allow someone to exactly replicate your study. Have a read at this procedure when you have time and think about what information is there, but also what information is not there, to help you develop your writing and your reports. For example, which fingers did the participants use to respond and why would that be important?
</p>
</div>
</div>
<p><br></p>
<p>We now have our data and we want to create some plots to visualise it. We will show you the code to create four types of plots and then get you to practice some yourself, but you will remember some of this from the PsyTeachR <a href="https://psyteachr.github.io/" target="_blank">Data Skills book</a>. As we go through the plots, you should edit/change the code we give you and see what differences you can control and what changes you can create in the plots. Editing and altering code that works to see what happens when you change something is a great way of working.</p>
</div>
<div id="basic-structure-of-ggplot" class="section level3" number="3.2.2">
<h3>
<span class="header-section-number">3.2.2</span> Basic Structure of <code>ggplot()</code><a class="anchor" aria-label="anchor" href="#basic-structure-of-ggplot"><i class="fas fa-link"></i></a>
</h3>
<p>The two main things to know about working with <code>ggplot</code> are that:</p>
<ol style="list-style-type: lower-alpha">
<li>the usual <code>ggplot</code> format is:</li>
</ol>
<p><code>ggplot(data, aes(x = x_axis, y = y_axis)) + geom_type_of_plot()</code></p>
<p>The first thing you enter is your dataframe/tibble; your <code>data</code>. Then, within the <code>aes()</code> you say what is on the <code>x_axis</code> and <code>y_axis</code>, using the column names from within your tibble. <code>aes</code> stands for aesthetics and maps data into visual features. Finally, you tell the code what type of plot you want.</p>
<ol start="2" style="list-style-type: lower-alpha">
<li>
<code>ggplot</code> works on a concept of layers</li>
</ol>
<p>Layers are a common way for graphics to work. Think about it as <code>ggplot()</code> function creating your first layer and then every function after that is adding more layers on top to create the figure you want. The first layer is always your data and the axis/axes, i.e. `ggplot(....). The second layer, added by using the plus symbol '+', is the type of plot. We will look at adding more layers as we progress.</p>
<p><code>ggplot()</code> is a powerful package that is used by a whole range of industries, including newspapers and mainstream media outlets, as it can make quite sophisticated images. One of the beauties of data skills is just how transferable they are across many fields.</p>
</div>
<div id="scatterplots---geom_point" class="section level3" number="3.2.3">
<h3>
<span class="header-section-number">3.2.3</span> Scatterplots - <code>geom_point()</code><a class="anchor" aria-label="anchor" href="#scatterplots---geom_point"><i class="fas fa-link"></i></a>
</h3>
<p>Scatterplots are a great way of visualising continuous data - data that can take any value on the scale it is measured. For example, in the current dataset, you can use scatterplots to explore the potential relationship between two continuous variables such as Age and Reaction Time: Do both variables increase/decrease at the same rate (i.e., a positive relationship)? Does one variable increase and the other decrease (i.e., a negative relationship)? Or maybe there is no overall relationship?</p>
<p>In our data, say we want to test if the overall average time to respond in the mental rotation task is related to the age of the participant while highlighting the sex of the participants. We could show this relationship in a scatterplot using the code below, which:</p>
<ol style="list-style-type: decimal">
<li>Wrangles the data to create an average response time for each participant, <code>Mean_Time</code>, and then joins this information to the demographic data, by <code>Participant</code>. All this is stored in the tibble <code>menrot_time_age</code>.</li>
<li>It then plots a scatterplot (<code>geom_point()</code>) where <code>age</code> is plotted on the x-axis, and <code>Mean_Time</code> is on the y-axis</li>
<li>Finally, it uses an additional <code>aes</code> call to <code>color</code> by <code>Sex</code> which will color each point based on whether it was a male or female participant responding. This is the default coloring of this call when there are two options. Later we will look at controlling this and using more colors ourselves.</li>
</ol>
<div class="sourceCode" id="cb88"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">menrot_time_age</span> <span class="op">&lt;-</span> <span class="fu">group_by</span><span class="op">(</span><span class="va">menrot</span>, <span class="va">Participant</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu">summarise</span><span class="op">(</span>Mean_Time <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">Time</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">inner_join</span><span class="op">(</span><span class="va">demog</span>, <span class="st">"Participant"</span><span class="op">)</span>

<span class="fu">ggplot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">menrot_time_age</span>, 
       <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">Age</span>, 
           y <span class="op">=</span> <span class="va">Mean_Time</span>, 
           color <span class="op">=</span> <span class="va">Sex</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_point</span><span class="op">(</span><span class="op">)</span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:dim1-1"></span>
<img src="03-s01-lab03b_files/figure-html/dim1-1-1.png" alt="A scatterplot of Mean Time as a function of Age" width="100%"><p class="caption">
Figure 3.2: A scatterplot of Mean Time as a function of Age
</p>
</div>
<p><span style="font-size: 22px; font-weight: bold; color: var(--green);">Quickfire Questions</span></p>
<ul>
<li><p>Looking at the scatterplot in Figure <a href="data-visualisation-through-ggplot2.html#fig:dim1-1">3.2</a>, what can you say about the relationship between age and overall response time? <select class="webex-select"><option value="blank"></option>
<option value="">as age increases, overall response time increases</option>
<option value="">as age increases, overall response time decreases</option>
<option value="answer">there is no overall relationship</option></select></p></li>
<li><p>Looking at the scatterplot, what can you say about difference between male and female participants? <select class="webex-select"><option value="blank"></option>
<option value="">males show more of an increase in overall response time with age than females</option>
<option value="">females show more of an increase in overall response time with age than males</option>
<option value="answer">there is no real difference between males and females in terms of overall response time and age</option></select></p></li>
</ul>
<div class="webex-solution">
<button>
Explain This - I don't get these answers
</button>
<div class="info">
<p>
If you look at the figure, does it appear that as age increases (x-axis) so does overall resposne time (y-axis)? Or as age decreases so does overall response time? Or maybe even as age increases, overall response time decreases? Well, actually, looking at the figure there appears to be no relationship between the two variables at all and it is not the case that as one either increases or decreases so does the other. The relationship appears flat.
</p>
<p>
When comparing sex, based on the color of the dots, again there appears to be no major differences here as the relationship looks flat for both sex.
</p>
<p>
Later in the book we will look at correlational analysis - a method of quantifying the relationship between two variables.
</p>
</div>
</div>
<p><br><strong>Note</strong>: It will often be the case that to visualise data you first have to wrangle it into a format. When we do this we will be using the functions we saw in Chapter 2, so make sure you have been through those tasks and have understood what the wrangle verbs are doing and how pipes work. Keep in mind that most functions use the format, <code>function(data, argument)</code></p>
</div>
<div id="histograms---geom_histogram" class="section level3" number="3.2.4">
<h3>
<span class="header-section-number">3.2.4</span> Histograms - geom_histogram()<a class="anchor" aria-label="anchor" href="#histograms---geom_histogram"><i class="fas fa-link"></i></a>
</h3>
<p>Histograms are a great way of showing the <strong>overall distribution</strong> of your data. Does your data look normally distributed? Or is your data skewed - positive skew or negative skew? Is it peaky? Is it flat? These are terms that will become familiar to you as you learn more about statistics, so try to think about these terms and concepts when visualising and looking at your data.</p>
<p>Looking at our data, say we wanted to test if the overall distribution of mean response times for correct trials was normally distributed. We could visualise this question through the following code, which:</p>
<ol style="list-style-type: decimal">
<li>Wrangles the data to create an average response time for each participant, <code>Mean_Time</code>, and then filters this information for correct trials only. This is then stored in the tibble <code>menrot_hist_correct</code>.</li>
<li>Plots a histogram (<code>geom_histogram()</code>) where <code>Mean_Time</code> is plotted on the x-axis, and the count of each value in <code>Mean_Time</code> is plotted on the y-axis. The code creates the y-axis automatically and we don't have to state it:</li>
</ol>
<div class="sourceCode" id="cb89"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">menrot_hist_correct</span> <span class="op">&lt;-</span> <span class="fu">group_by</span><span class="op">(</span><span class="va">menrot</span>, <span class="va">Participant</span>, <span class="va">CorrectResponse</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu">summarise</span><span class="op">(</span>Mean_Time <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">Time</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">CorrectResponse</span> <span class="op">==</span> <span class="st">"Correct"</span><span class="op">)</span>

<span class="fu">ggplot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">menrot_hist_correct</span>, 
       <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">Mean_Time</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu">geom_histogram</span><span class="op">(</span><span class="op">)</span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:dim2-1"></span>
<img src="03-s01-lab03b_files/figure-html/dim2-1-1.png" alt="A histogram of distribution of Mean Time counts" width="100%"><p class="caption">
Figure 3.3: A histogram of distribution of Mean Time counts
</p>
</div>
<p><span style="font-size: 22px; font-weight: bold; color: var(--green);">Quickfire Questions</span></p>
<ul>
<li><p>Looking at the histogram in Figure <a href="data-visualisation-through-ggplot2.html#fig:dim2-1">3.3</a>, what can you say about the overall shape of the distribution? <select class="webex-select"><option value="blank"></option>
<option value="answer">the data looks reasonably normally distributed</option>
<option value="">the data looks positively skewed</option>
<option value="">the data looks negatively skewed</option></select></p></li>
<li><p>Looking at the histogram, what is the most common average overall response time for correct trials? <select class="webex-select"><option value="blank"></option>
<option value="">approximately 2000 milliseconds</option>
<option value="answer">approximately 2500 milliseconds</option>
<option value="">approximately 3000 milliseconds</option></select></p></li>
</ul>
<div class="webex-solution">
<button>
Explain This - I don't get these answers
</button>
<div class="info">
<p>
Keep in mind that real data will never give that beautiful textbook shape that you see in classic diagrams when looking for normally distributed data or skewed data. Your decisions regarding your distributions will often require a degree of judgement.
</p>
<p>
Positive skewed data means that most of the data is shifted to the left (low numbers) with a tail stretching to the right (high numbers). Negative skew is where most of the data is shifted to the right (high numbers) with a tail stretching to the left (low numbers). Normally distributed data has most of the data in the middle with even tails on either side. Although not perfect, the data shown in our histogram is a reasonable representation of normally distributed data in the real world; particularly for a small sample of participants.
</p>
<p>
As the y-axis is the count of the values on the x-axis, the most common overall response time can be found by reading the highest column of the data. For this distribution, this looks to be around 2500 milliseconds or 2.5 seconds.
</p>
</div>
</div>
</div>
<div id="boxplots---geom_boxplot" class="section level3" number="3.2.5">
<h3>
<span class="header-section-number">3.2.5</span> Boxplots - geom_boxplot()<a class="anchor" aria-label="anchor" href="#boxplots---geom_boxplot"><i class="fas fa-link"></i></a>
</h3>
<p>Boxplots are a great means for visualising the <strong>spread</strong> of your data and for highlighting <strong>outliers</strong> in your data. When looking at boxplots, you should consider:</p>
<ul>
<li>whether the median (thick horizontal black line) is in the middle of its box or is higher or lower than the middle of the box?</li>
<li>whether the box is evenly distributed around the median or not?</li>
<li>are the box whiskers (vertical tails at top and bottom of box) a similar length on both sides of the box?</li>
<li>are there any outliers - usually highlighted as a star or a dot beyond the whiskers?</li>
</ul>
<p>Let's look at and compare the distributions of mean reaction times for correct and incorrect responses. This can be done using the below code, which:</p>
<ol style="list-style-type: decimal">
<li>Repeats the first two wrangle steps as when we created a scatterplot, but additionally groups by <code>CorrectResponse</code>, and stores the data in the tibble <code>menrot_box_correct</code>
</li>
<li>Plots a boxplot (<code>geom_boxplot()</code>) of the overall average response times on the y-axis, <code>Mean_Time</code>, based on the condition, <code>CorrectResponse</code>, on the x-axis</li>
<li>Uses an additional <code>aes</code> call to <code>fill</code> the colour of the boxplots, of the two categories, based on whether <code>CorrectResponse</code> was correct or incorrect. Again these are default and we will look at editing this later.</li>
<li>Turns off the legend using the <code>guides()</code> call as it isn't needed because the x-axis tells you which group is which. More on that later though.</li>
</ol>
<p>Run the code as is first. Then, run the code with <code>fill = TRUE</code> instead. What's the difference? Notice that <code>fill</code> is the name of the call in the <code>ggplot(...)</code> function. They are linked.</p>
<div class="sourceCode" id="cb90"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">menrot_box_correct</span> <span class="op">&lt;-</span> <span class="fu">group_by</span><span class="op">(</span><span class="va">menrot</span>, <span class="va">Participant</span>, <span class="va">CorrectResponse</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu">summarise</span><span class="op">(</span>Mean_Time <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">Time</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">inner_join</span><span class="op">(</span><span class="va">demog</span>, <span class="st">"Participant"</span><span class="op">)</span>

<span class="fu">ggplot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">menrot_box_correct</span>, 
       <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">CorrectResponse</span>, 
           y <span class="op">=</span> <span class="va">Mean_Time</span>, 
           fill <span class="op">=</span> <span class="va">CorrectResponse</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu">geom_boxplot</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">guides</span><span class="op">(</span>fill <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></code></pre></div>
<pre><code>## `summarise()` has grouped output by 'Participant'. You can override using the `.groups` argument.</code></pre>
<pre><code>## Warning: `guides(&lt;scale&gt; = FALSE)` is deprecated. Please use `guides(&lt;scale&gt; =
## "none")` instead.</code></pre>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:dim4-1"></span>
<img src="03-s01-lab03b_files/figure-html/dim4-1-1.png" alt="A boxplot of the spreads of Mean Time for Correct and Incorrect Responses" width="100%"><p class="caption">
Figure 3.4: A boxplot of the spreads of Mean Time for Correct and Incorrect Responses
</p>
</div>
<p><span style="font-size: 22px; font-weight: bold; color: var(--green);">Quickfire Questions</span></p>
<ul>
<li><p>Looking at the boxplots, how many outliers were there? <select class="webex-select"><option value="blank"></option>
<option value="">1</option>
<option value="">2</option>
<option value="">3</option>
<option value="answer">0</option></select></p></li>
<li><p>Looking at the boxplots in Figure <a href="data-visualisation-through-ggplot2.html#fig:dim4-1">3.4</a>, which condition has the longer median overall average response time to the mental rotation task? <select class="webex-select"><option value="blank"></option>
<option value="">Median response time was longer for the Correct responses</option>
<option value="answer">Median response time was longer for the Incorrect responses</option>
<option value="">Both medians are the same approximately</option></select></p></li>
</ul>
<div class="webex-solution">
<button>
Explain This - I don't get these answers
</button>
<div class="info">
<p>
There are a number of ways of determining outliers. Two methods are through standard deviations (usually 2.5 or 3 SD are used as cut-offs) or through boxplots, where an outlier is determined as <span class="math inline"><span class="math inline">\(1.5*IQR\)</span></span> (inter-quartile range) above or below the top and bottom of the box. Outliers are shown as dots above or below the whiskers of the boxplot. As you can see in the figure there are no outliers to see in this data.
</p>
<p>
The median is one of the five values required to make a boxplot and is shown as the horizontal thick black line within the box itself. Looking at the two conditions and comparing the position of the median on the y-axis (response time) we can see that the median response time for incorrect trials was higher than correct trials. This would suggest that people take longer to make up their mind and to give a decision on the trials that they get wrong. Makes sense if you think about it; uncertainty takes longer and leads to more errors.
</p>
</div>
</div>
</div>
<div id="barplots---geom_bar-or-geom_col" class="section level3" number="3.2.6">
<h3>
<span class="header-section-number">3.2.6</span> Barplots - geom_bar() or geom_col()<a class="anchor" aria-label="anchor" href="#barplots---geom_bar-or-geom_col"><i class="fas fa-link"></i></a>
</h3>
<p>Barplots typically show <strong>specific values of a condition</strong>. Sometimes this will be really simple like the <strong>count</strong> of a variable the mean, e.g. how many people replied yes. Others will show something a bit more complex such as the <strong>average spread of values</strong> via <strong>error bars</strong>, e.g. standard error. When looking at barplots, the main considerations are whether or not there appears to be a difference between the conditions you are interested in or whether all conditions are about the same.</p>
<p>It is worth knowing that barplots are now used less frequently than they were as they actually do not show a lot of information, as discussed in this blog, <a href="https://garstats.wordpress.com/2016/03/09/one-simple-step-to-improve-statistical-inferences/" target="_blank">One simple step to improving statistical inference</a>. However, you will still see them being used so it is great to be able to create and interpret them.</p>
<p><strong>Using <code>geom_bar()</code></strong></p>
<p>Using our data, let's say we are interested in whether there is a difference in the average percentage of correct and incorrect responses across male and female participants. We could visualise this using the following code, which:</p>
<ol style="list-style-type: decimal">
<li>Wrangles the data through a series of steps to establish the overall percent average for correct and incorrect responses for both sex, stored in <code>menrot_resp_sex</code>.</li>
<li>Plots a barplot (<code>geom_bar()</code>) with the condition <code>Sex</code> on the x-axis, the <code>Avg_Percent</code> on the y-axis, created through the wrangle, and <code>fill</code> the bars based on <code>CorrectResponse</code>.</li>
<li>Finally, within the <code>geom_bar</code> it says to treat the data as final values and not to average them, <code>stat = "identity"</code>, and makes both columns visible by moving them apart <code>position = position_dodge(.9))</code> - without this last step the bars would overlap and you wouldn't see everything. Try changing the <code>.9</code>.</li>
<li>Note: Each participant did 96 trials in this study.</li>
</ol>
<div class="sourceCode" id="cb93"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">total_n_trials</span> <span class="op">&lt;-</span> <span class="fl">96</span>

<span class="va">menrot_resp_sex</span> <span class="op">&lt;-</span> <span class="fu">count</span><span class="op">(</span><span class="va">menrot</span>, <span class="va">Participant</span>, <span class="va">CorrectResponse</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu">inner_join</span><span class="op">(</span><span class="va">demog</span>, <span class="st">"Participant"</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">mutate</span><span class="op">(</span>PercentPerParticipant <span class="op">=</span> <span class="op">(</span><span class="va">n</span><span class="op">/</span><span class="va">total_n_trials</span><span class="op">)</span><span class="op">*</span><span class="fl">100</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">group_by</span><span class="op">(</span><span class="va">Sex</span>, <span class="va">CorrectResponse</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">summarise</span><span class="op">(</span>Avg_Percent <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">PercentPerParticipant</span><span class="op">)</span><span class="op">)</span>

<span class="fu">ggplot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">menrot_resp_sex</span>, 
       <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">Sex</span>, 
           y <span class="op">=</span> <span class="va">Avg_Percent</span>, 
           fill <span class="op">=</span> <span class="va">CorrectResponse</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu">geom_bar</span><span class="op">(</span>stat <span class="op">=</span> <span class="st">"identity"</span>, 
           position <span class="op">=</span> <span class="fu">position_dodge</span><span class="op">(</span><span class="fl">.9</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>## `summarise()` has grouped output by 'Sex'. You can override using the `.groups` argument.</code></pre>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:dim5-1"></span>
<img src="03-s01-lab03b_files/figure-html/dim5-1-1.png" alt="A barplot of the average percent Correct and Incorrect responses for Female and Male participants - using geom_bar()" width="100%"><p class="caption">
Figure 3.5: A barplot of the average percent Correct and Incorrect responses for Female and Male participants - using geom_bar()
</p>
</div>
<p><br></p>
<p><strong>Using <code>geom_col()</code></strong></p>
<p><code>geom_col()</code> - short for column - is an alternative to <code>geom_bar()</code> that does not require the part of the code where you say to not do anything to the data, i.e. <code>stat="identity"</code>. This is shown below. Notice the difference in codes, but that they produce the same figure.</p>
<div class="sourceCode" id="cb95"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">ggplot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">menrot_resp_sex</span>, 
       <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">Sex</span>, 
           y <span class="op">=</span> <span class="va">Avg_Percent</span>, 
           fill <span class="op">=</span> <span class="va">CorrectResponse</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_col</span><span class="op">(</span>position <span class="op">=</span> <span class="fu">position_dodge</span><span class="op">(</span><span class="fl">.9</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:dim6-1"></span>
<img src="03-s01-lab03b_files/figure-html/dim6-1-1.png" alt="A barplot of the average percent Correct and Incorrect responses for Female and Male participants - using geom_col()" width="100%"><p class="caption">
Figure 3.6: A barplot of the average percent Correct and Incorrect responses for Female and Male participants - using geom_col()
</p>
</div>
<p><span style="font-size: 22px; font-weight: bold; color: var(--green);">Quickfire Questions</span></p>
<ul>
<li><p>Looking at the barplot and data, on average, which sex had the most correct responses? <select class="webex-select"><option value="blank"></option>
<option value="answer">female</option>
<option value="">male</option>
<option value="">both the same</option>
<option value="">can't tell</option></select></p></li>
<li><p>Looking at the barplot and data, on average, which sex had the most incorrect responses? <select class="webex-select"><option value="blank"></option>
<option value="">female</option>
<option value="answer">male</option>
<option value="">both the same</option>
<option value="">can't tell</option></select></p></li>
<li><p>Looking at the code, what happens if you decrease the position.dodge() value? <select class="webex-select"><option value="blank"></option>
<option value="">the bars get further apart</option>
<option value="answer">the bars start to overlap</option>
<option value="">nothing changes in the figure</option></select></p></li>
<li><p>Looking at the code, what happens if you change the aes call of <code>fill</code> to <code>color</code>? <select class="webex-select"><option value="blank"></option>
<option value="">the bars will stay a different color</option>
<option value="answer">the bars become grey and the outlines become different colors</option>
<option value="">nothing changes in the figure</option></select></p></li>
</ul>
<div class="webex-solution">
<button>
Explain This - I don't get these answers
</button>
<div class="info">
<p>
Remember that in barplots plotting the mean, the top of the column is the average value of that condition. This is actually why people do not like barplots; though commonly used, they really only show you one value for your data, the average, and they disregard all other information unless some indication of spread is given.
</p>
<p>
With that in mind, comparing the two Correct columns we can see that females had on average more correct responses than males. Doing the same for the Incorrect columns we can see that males had more incorrect responses than females. This actually makes sense as the response option in the experiment was either correct or incorrect, so when you add all the correct and incorrect percentage responses for one sex together you should get 100%. If females gave more correct reponses then they must have given less incorrect responses.
</p>
<p>
The last two questions are about playing with the code. Remember we said that plots work through a concept of layers. If you set <code>position.dodge()</code> to 0, you will find that one of the columns disappears because they completely overlap now. So we need to set <code>position.dodge()</code> to a reasonable value to have the columns separate. Why not set it at 1? In barplots, you often find that the different levels (or categories) of the the same variable are touching. Note, however, that the value of the dodge, in this case 1, is relative to the size of the x-axis - if the scale of your x-axis ran from 0 to 100 then a dodge of 1 will have very little effect. Sometimes you need a little trial and error. Always look at the output of your code.
</p>
<p>
The final point shows that you can add a lot more calls than just x and y axis to change the presentation of your figures. <code>fill</code> changes the color of the columns, <code>color</code> changes the outline color of the columns. We will see more of these as we progress and we will look at the difference between putting them inside the <code>aes()</code> and outside of it. Have a play about with these on other figures and see what happens. It is worth pointing out here though, above where we turned the legend off using <code>guides(fill = FALSE)</code>, that works because we used the <code>fill = ...</code> call to change colours. If we had used the <code>color = ...</code> call to change colours we need to use <code>guides(colors = FALSE)</code> to turn off the legend. See how they are linked? The guide matches what you called.
</p>
</div>
</div>
</div>
<div id="themes-labels-guides-and-facet_wraps" class="section level3" number="3.2.7">
<h3>
<span class="header-section-number">3.2.7</span> Themes, Labels, Guides, and <strong><code>facet_wraps()</code></strong><a class="anchor" aria-label="anchor" href="#themes-labels-guides-and-facet_wraps"><i class="fas fa-link"></i></a>
</h3>
<p>There are a couple of other layers you can add to your <code>ggplot</code> calls to make your figures look more professional. We will show you the code here, but we want you to run them and teach yourself how they work by changing the code, removing parts within ggplot, and by adding them to the other figures we have shown above.</p>
<ul>
<li>
<p><code>themes</code> - changing the overall presentation of your figure. Try running the below code and comparing the figure to the barplot above. Remember, <code>?theme_bw()</code> will give some information or look at the cheatsheets for different themes such as <code>theme_light()</code>, <code>theme_classic()</code>, <code>theme_gray()</code> and <code>theme_dark()</code>.</p>
<ul>
<li>
<code>theme_gray()</code> is actually the default and is equivalent to not stating any theme function.
_ <code>theme_classic()</code> is very close to a basic APA figure presentation.</li>
</ul>
</li>
<li><p><code>labs</code> - putting appropriate labels on your figures so readers understand what is being displayed. Try changing the text within the quotes.</p></li>
<li><p><code>facet_wraps</code> - splitting data into separate figures for clarity. This will only work when one of your conditions is categorical, but it can be a really effective means of displaying information.</p></li>
<li><p><code>guides</code> - remove it and see what happens. Do you understand why we use <code>fill</code> in this situation, but perhaps not others?</p></li>
</ul>
<p>Try running and editing this code:</p>
<div class="sourceCode" id="cb96"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">total_n_trials</span> <span class="op">&lt;-</span> <span class="fl">96</span>

<span class="va">menrot_better_plot</span> <span class="op">&lt;-</span> <span class="fu">count</span><span class="op">(</span><span class="va">menrot</span>, <span class="va">Participant</span>, <span class="va">CorrectResponse</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu">inner_join</span><span class="op">(</span><span class="va">demog</span>, <span class="st">"Participant"</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">mutate</span><span class="op">(</span>PercentPerParticipant <span class="op">=</span> <span class="va">n</span><span class="op">/</span><span class="va">total_n_trials</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">group_by</span><span class="op">(</span><span class="va">Sex</span>, <span class="va">CorrectResponse</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">summarise</span><span class="op">(</span>Avg_Percent <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">PercentPerParticipant</span><span class="op">)</span><span class="op">)</span>

<span class="fu">ggplot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">menrot_better_plot</span>, 
       <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">Sex</span>,
           y <span class="op">=</span> <span class="va">Avg_Percent</span>, 
           fill <span class="op">=</span> <span class="va">CorrectResponse</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu">geom_col</span><span class="op">(</span>position <span class="op">=</span> <span class="fu">position_dodge</span><span class="op">(</span><span class="fl">.9</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">labs</span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Sex of Participant"</span>, 
       y <span class="op">=</span> <span class="st">"Percent Average (%)"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">guides</span><span class="op">(</span>fill <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">facet_wrap</span><span class="op">(</span><span class="op">~</span><span class="va">CorrectResponse</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">theme_bw</span><span class="op">(</span><span class="op">)</span></code></pre></div>
</div>
<div id="choosing-appropriate-figures" class="section level3" number="3.2.8">
<h3>
<span class="header-section-number">3.2.8</span> Choosing Appropriate Figures<a class="anchor" aria-label="anchor" href="#choosing-appropriate-figures"><i class="fas fa-link"></i></a>
</h3>
<p>As you progress through Psychology, you will come across a variety of different figures and plots, each looking slightly different and giving different information. When looking at these figures, and indeed when choosing one for your own analyses, you have to think about which figure is the most appropriate for your data. For example, scatterplots are great when both variables are continuous; boxplots and histograms are great for viewing spreads of data; barplots are commonly used where one variable is categorical - but as above note that barplots can be misleading and lots of new approaches to display categorical information are being created. Violin-boxplots that were taught in Chapter 7 of the <a href="https://psyteachr.github.io/" target="_blank">Data Skills book</a> provide a more complete way of data visualisation. Always keep asking yourself, does my plot display my data correctly. Also, do I have the right number of dots/conditions/groups in my figure? Too many or too few would suggest something is not quite right. Look at your data!</p>

</div>
</div>
<div id="data-visualisation-application" class="section level2" number="3.3">
<h2>
<span class="header-section-number">3.3</span> Data Visualisation Application<a class="anchor" aria-label="anchor" href="#data-visualisation-application"><i class="fas fa-link"></i></a>
</h2>
<div id="mental-rotation-angle-and-reaction-time" class="section level3" number="3.3.1">
<h3>
<span class="header-section-number">3.3.1</span> Mental Rotation: Angle and Reaction Time<a class="anchor" aria-label="anchor" href="#mental-rotation-angle-and-reaction-time"><i class="fas fa-link"></i></a>
</h3>
<p>We will continue using the data set from <a href="https://openpsychologydata.metajnl.com/articles/10.5334/jopd.ai/" target="_blank">Ganis and Kievit (2016)</a>. To further your understanding of this experiment as well as develop your skills in visualisation and interpretation, we will look at mean reaction time for correct trials, as a function of the angle of rotation and sex. The idea is that the more rotated a test image is from an original image, the longer it will take for participants to determine if they are the same image or if they are completely different images. Fifty-four participants responded 'same' or 'different' on each trial to a series of rotated images using four angles of rotation (0, 50, 100, 150 degrees rotated compared to the original). <a href="data/03-s01/inclass/ch3-inclass-data.zip">Link to the data</a>.</p>
<div class="webex-solution">
<button>
Explain This - What does 'as a function of' mean?
</button>
<div class="info">
<p>
You will come across this phrase 'as a function of' quite a bit when dealing with visualisations. It means something like 'compared by' or 'across'. So you could say we are going to look at Mean Reaction Time across the four different Angles of Rotation which would be written as Mean Reaction Time as a function of Angle of Rotation. Usually, it would be plotted as y-axis as a function of x-axis. It is a similar idea to the functions we use in our codes in that you want to see what happens when you put y in the function x. It is good to become familiar with the terms and language that is used in reports so that a) you understand what you are reading and b) you can use the same language in your writing.
</p>
</div>
</div>
</div>
<div id="Ch3InClassQueT1" class="section level3" number="3.3.2">
<h3>
<span class="header-section-number">3.3.2</span> Task 1: Loading and Viewing the Data<a class="anchor" aria-label="anchor" href="#Ch3InClassQueT1"><i class="fas fa-link"></i></a>
</h3>
<ol style="list-style-type: decimal">
<li>Download the data, unzip it, and save it to a folder you have access to.</li>
<li>Set your working directory to the folder with your data in it.</li>
<li>Start a new script or .Rmd file (RMarkdown), save it to the folder with your data in it.</li>
<li>In your script, load in the <code>tidyverse</code> library.</li>
<li>Load in both datasets exactly as we did before, storing the experimental data in <code>menrot</code> and the demographic data in <code>demog</code>.</li>
</ol>
<div class="webex-solution">
<button>
Helpful Hint
</button>
<div class="info">
<p>
library()
</p>
<p>
menrot &lt;- read_csv()
</p>
<p>
demog &lt;- read_csv()
</p>
</div>
</div>
<p><br>
Remember to always be looking at your data as good practice and to make sure it is as you expect it to be. Use either <code><a href="https://rdrr.io/r/utils/View.html">View()</a></code> or <code>glimpse()</code>, but do this in the console window of RStudio, never in your script or .Rmd file. Other useful functions that you can use to check your data structure are:</p>
<ol style="list-style-type: decimal">
<li>
<code><a href="https://rdrr.io/r/utils/str.html">str()</a></code> - This shows what type your data is. Look for words like table, dataframe, <a class="glossary" target="_blank" title="A data type representing strings of text." href="https://psyteachr.github.io/glossary/c#character">character</a>, <a class="glossary" target="_blank" title="A data type representing whole numbers." href="https://psyteachr.github.io/glossary/i#integer">integer</a>, <a class="glossary" target="_blank" title="A data type representing a real decimal number" href="https://psyteachr.github.io/glossary/d#double">double</a>.</li>
<li>
<code><a href="https://rdrr.io/r/utils/head.html">head()</a></code>, <code><a href="https://rdrr.io/r/utils/head.html">tail()</a></code>, and <code><a href="https://rdrr.io/r/base/names.html">names()</a></code> - These show the top six and bottom six rows with column names, or just the column names with <code><a href="https://rdrr.io/r/base/names.html">names()</a></code>.</li>
<li>
<code><a href="https://rdrr.io/r/base/dim.html">dim()</a></code> - This shows the dimensions of the data.</li>
</ol>
<p>Refer to the previous section for a list of what all the columns refer to if you are not sure. And keep in mind that to be reproducible means being careful with the spelling and punctuation of the names of functions, tibbles, columns, conditions, etc, at all times - e.g. <code>Juggler</code> is not the same as <code>juggler</code>.</p>
<p><span style="font-size: 22px; font-weight: bold; color: var(--green);">Quickfire Questions</span></p>
<p>Take a couple of minutes to try the above functions and to answer the following questions.</p>
<ul>
<li><p>From the options, what type of data is the variable <code>Angle</code>, found in the dataframe <code>menrot</code>? <select class="webex-select"><option value="blank"></option>
<option value="">character</option>
<option value="">integer</option>
<option value="answer">double/numerical</option></select></p></li>
<li><p>Type in the box the name of the dataframe that contains information regarding the sex of the participants: <input class="webex-solveme nospaces" size="8" data-answer='["demog"]'></p></li>
<li><p>From the options, which of these is a column within <code>menrot</code>? <select class="webex-select"><option value="blank"></option>
<option value="">Correctresponse</option>
<option value="">CorretcResponse</option>
<option value="answer">CorrectResponse</option>
<option value="">correctReponse</option></select></p></li>
<li><p>From the options, according to the dim() call, how many rows are there in demog? <select class="webex-select"><option value="blank"></option>
<option value="">3</option>
<option value="">8</option>
<option value="answer">54</option>
<option value="">5184</option></select></p></li>
</ul>
<div class="webex-solution">
<button>
Explain This - I don't get these answers
</button>
<div class="info">
<p>
This is about making sure you are loading in your data correctly, using the instructed names - so that you are being reproducible - and that you understand the data you are looking at. If you completed Task 1 successfully, loading in the data to the correct dataframes, then the following answers should work in the above questions.
</p>
<ol style="list-style-type: decimal">
<li>
<p>
calling <code><a href="https://rdrr.io/r/utils/str.html">str(menrot)</a></code> and looking through the information that comes out you should see that the data in the column <code>Angle</code> are loaded in as double/numerical. Technically they are integers (whole numbers with no decimal places), but the default load in would make them numerical.
</p>
</li>
<li>
<p>
<code>demog</code> should have been where you loaded information regarding the demographics including sex of participant.
</p>
</li>
<li>
<p>
<code><a href="https://rdrr.io/r/base/names.html">names(menrot)</a></code> will give you column names. This question is about making sure of the correct spelling: CorrectResponse. All the other spellings would not work in this data as spelling of column names is specific!
</p>
</li>
<li>
<p>
<code><a href="https://rdrr.io/r/base/dim.html">dim(demog)</a></code> shows you the number of rows (54) by the number of columns (3).
</p>
</li>
</ol>
</div>
</div>
</div>
<div id="Ch3InClassQueT2" class="section level3" number="3.3.3">
<h3>
<span class="header-section-number">3.3.3</span> Task 2: Recreating the Figure<a class="anchor" aria-label="anchor" href="#Ch3InClassQueT2"><i class="fas fa-link"></i></a>
</h3>
<p>Let's start by making a representation of the top part of Figure 2 in <a href="https://openpsychologydata.metajnl.com/articles/10.5334/jopd.ai/" target="_blank">Ganis and Kievit (2016)</a> - Mean Reaction Time as a function of Angle of Rotation.</p>
<ol style="list-style-type: decimal">
<li><p>Copy the lines of code below into your script.</p></li>
<li>
<p>Replace the <code>NULL</code>s in order to recreate the figure below similar to that of Ganis and Kievit (2016) Figure 2 (top).</p>
<ul>
<li>Note that this figure shows information for only correct responses just as in Ganis and Kievit (2016).</li>
<li>Remember <code>ggplot</code> is a case of layers. The first layer says where is my data and what do I want on each axis. Every subsequent layer says how I want the data displayed - points (<code>geom_point()</code>) with a connecting line (<code>geom_line()</code>).</li>
<li>After running through all these tasks, come back to this one and see if you can figure out what <code>coord_cartesian()</code> does by changing the numbers in the <code>ylim = ()</code> call. There is a comment on this in the solutions.</li>
</ul>
</li>
</ol>
<div class="sourceCode" id="cb97"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">menrot_angle</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">menrot</span>, <span class="va">CorrectResponse</span> <span class="op">==</span> <span class="cn">NULL</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">inner_join</span><span class="op">(</span><span class="va">demog</span>, <span class="cn">NULL</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">group_by</span><span class="op">(</span><span class="cn">NULL</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu">summarise</span><span class="op">(</span>mean_Resp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="cn">NULL</span><span class="op">)</span><span class="op">)</span>

<span class="fu">ggplot</span><span class="op">(</span>data <span class="op">=</span> <span class="cn">NULL</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="cn">NULL</span>, y <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu">geom_point</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_line</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">coord_cartesian</span><span class="op">(</span>ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">3500</span><span class="op">)</span>, expand <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></code></pre></div>
<div class="webex-solution">
<button>
Helpful Hint
</button>
<div class="info">
<p>
The first four lines, to create <code>menrot_angle</code>, are all functions from the Wickham Six verbs so refer back to see how they work.
</p>
<ol style="list-style-type: decimal">
<li>
<p>
Which answer in <code>CorrectResponse</code> would allow you to keep just the correct answers?
</p>
</li>
<li>
<p>
What common variable will allow you to join this information to <code>demog</code>?
</p>
</li>
<li>
<p>
You only really care about the four levels of rotation, so what variable/column will you <code>group_by</code>?
</p>
</li>
<li>
<p>
Which variable/column do you want the mean of for a mean response time?
</p>
</li>
</ol>
<p>
For the <code>ggplot</code> line, think of the format, data, then the x-axis name, then the y-axis name.
</p>
</div>
</div>
<p><br></p>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:Ch3InClassTask2-hidden"></span>
<img src="03-s01-lab03c_files/figure-html/Ch3InClassTask2-hidden-1.png" alt="Basic Scatterplot of Response Time by Angle of Rotation" width="100%"><p class="caption">
Figure 3.7: Basic Scatterplot of Response Time by Angle of Rotation
</p>
</div>
<p><span style="font-size: 22px; font-weight: bold; color: var(--pink);">Thinking Cap Point</span></p>
<p>Great, you have replicated the figure! However, do you know what it means? What does the figure tell you about mean reaction time and angle of rotation, and how does it fit with the overall theory we introduced above? Answering this question may help:</p>
<ul>
<li>From the options, the figure would suggest that as angle of rotation increases: <select class="webex-select"><option value="blank"></option>
<option value="">mean reaction time decreases</option>
<option value="">mean reaction time stays the same</option>
<option value="answer">mean reaction time increases</option></select>
</li>
</ul>
<div class="webex-solution">
<button>
Portfolio Point - Reaction Time as a function of Rotation
</button>
<div class="info">
<p>
As you can see from the figure, consistent with Shepard and Metzler (1971), the participants from Ganis and Kievit (2016) showed an increase in reaction time as the angle of rotation increased. Therefore, Ganis and Kievit (2016) have replicated the findings of Shepard and Metzler (1971).
</p>
<p>
A quick note though is that, yes, mean reaction time does increase with angle of rotation, but it is not a consistent increase. You will see that the difference between mean reaction times for 150 and 100 degrees is smaller than between 0 and 50. Reaction times start to plateau after a certain angle of rotation.
</p>
</div>
</div>
</div>
<div id="Ch3InClassQueT3" class="section level3" number="3.3.4">
<h3>
<span class="header-section-number">3.3.4</span> Task 3: Examining Additional Variable Effects<a class="anchor" aria-label="anchor" href="#Ch3InClassQueT3"><i class="fas fa-link"></i></a>
</h3>
<p>In the previous section, we looked at sex of participant and that was quite interesting. It is not covered in Ganis and Kievit (2016), so let us take a look at it for them.</p>
<ol style="list-style-type: decimal">
<li>To your pipeline of Task 2, add the variable <code>Sex</code> to the <code>group_by()</code> function to group the data by <code>Angle</code> and <code>Sex</code>.</li>
<li>Running the code again creates the below figure.</li>
</ol>
<div class="webex-solution">
<button>
Helpful Hint
</button>
<div class="info">
<!-- `group_by(Angle, Sex)` -->
<p>
Remember, to add more grouping variables just separate them by a comma. Everything else in our code stays the same.
</p>
</div>
</div>
<p><br></p>
<pre><code>## `summarise()` has grouped output by 'Angle'. You can override using the `.groups` argument.</code></pre>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:Ch3InClassTask3-hidden"></span>
<img src="03-s01-lab03c_files/figure-html/Ch3InClassTask3-hidden-1.png" alt="Separating points by Sex" width="100%"><p class="caption">
Figure 3.8: Separating points by Sex
</p>
</div>
<p>Hmmm, that figure does not look that informative. It looks similar to the one we created but the dots have doubled - we now have 8 instead of 4 - but we do not know which is male or female, and the connecting line is confusing. We need to add a little more to the code to tell it how to separate the data based on Sex.</p>
</div>
<div id="Ch3InClassQueT4" class="section level3" number="3.3.5">
<h3>
<span class="header-section-number">3.3.5</span> Task 4: Grouping the Figure Data<a class="anchor" aria-label="anchor" href="#Ch3InClassQueT4"><i class="fas fa-link"></i></a>
</h3>
<ol style="list-style-type: decimal">
<li>In the previous section we used <code>fill</code> and <code>color</code> inside the <code>aes()</code> to change basic information about the figure. There is also one called <code>group</code>. Add a <code>group</code> call inside your <code>aes(...)</code> to separate the data by <code>Sex</code>.</li>
<li>Run the code again and see what your figure looks like</li>
</ol>
<div class="webex-solution">
<button>
Helpful Hint
</button>
<div class="info">
<p>
<code>ggplot(....., aes(x = , y = , group = ???))</code>
</p>
</div>
</div>
<p><br></p>
<p>You should now at least see different lines for the two sex, but we still can't tell which sex is which line, can we? It just looks like two black parallel lines, one slightly higher than the other. What would be ideal would be changing the color of the points based on whether they are from male or female participants! Fortunately, the <code>geoms</code> can also take information as well.</p>
</div>
<div id="Ch3InClassQueT5" class="section level3" number="3.3.6">
<h3>
<span class="header-section-number">3.3.6</span> Task 5: Identifying Groups Using <strong><code>aes()</code></strong><a class="anchor" aria-label="anchor" href="#Ch3InClassQueT5"><i class="fas fa-link"></i></a>
</h3>
<ol style="list-style-type: decimal">
<li>Add an <code>aes()</code> call inside your <code>geom_point()</code> function to <code>color</code> the dots by <code>Sex</code>.</li>
</ol>
<div class="webex-solution">
<button>
Helpful Hint
</button>
<div class="info">
<p>
<code>geom_point(aes(??? = ???)</code>
</p>
</div>
</div>
<p><br>
You should now have something like this:
<br></p>
<pre><code>## `summarise()` has grouped output by 'Angle'. You can override using the `.groups` argument.</code></pre>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:Ch3InClassTask5-hidden"></span>
<img src="03-s01-lab03c_files/figure-html/Ch3InClassTask5-hidden-1.png" alt="Separate lines for each Sex" width="100%"><p class="caption">
Figure 3.9: Separate lines for each Sex
</p>
</div>
<p>Great! We can now see that the female line is on top and the male line is on the bottom. But before we start interpreting this figure let's finish tidying it up with a few more tasks. For example the dots for each data point are perhaps a little small to see, so we could increase them in size. Also, color is great if you can print in color, but we could also change the shape of the dots to help people distinguish between the Sex for when displaying in color isn't an option. To do this we will use the additional calls of <code>shape</code> and <code>size</code> within our <code>geom_point()</code>.</p>
</div>
<div id="Ch3InClassQueT6" class="section level3" number="3.3.7">
<h3>
<span class="header-section-number">3.3.7</span> Task 6: Changing the Shape and Size of Data Points<a class="anchor" aria-label="anchor" href="#Ch3InClassQueT6"><i class="fas fa-link"></i></a>
</h3>
<ol style="list-style-type: decimal">
<li><p>We want each Sex to have different shaped points, so add a call to <code>shape</code> within the <code>aes()</code> call of our <code>geom_point()</code> function, just like you did for color.</p></li>
<li><p>However, we want each Sex to have the same size of point, so add a call to <code>size</code> within the <code>geom_point()</code> function, but not inside the <code>aes()</code> call. Set an appropriate number for the size instead of naming a variable. Maybe <code>size = 3</code>?</p></li>
</ol>
<div class="webex-solution">
<button>
Helpful Hint
</button>
<div class="info">
<p>
<code>geom_point(aes(color = Sex, Shape = ???), size = ???)</code>
</p>
</div>
</div>
<p><br></p>
<p>This should give you a figure like this:</p>
<pre><code>## `summarise()` has grouped output by 'Angle'. You can override using the `.groups` argument.</code></pre>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:Ch3InClassTask6-hidden"></span>
<img src="03-s01-lab03c_files/figure-html/Ch3InClassTask6-hidden-1.png" alt="Changing Shape and Size of Data Points" width="100%"><p class="caption">
Figure 3.10: Changing Shape and Size of Data Points
</p>
</div>
<p><strong>A quick point - in, out, what's the aes about?</strong></p>
<p>Hopefully you are beginning to spot the difference between setting a call within <code>aes()</code> (which stands for aesthetics) and setting outside the <code>aes()</code>. Outside <code>aes()</code> means that all observations take the one value or color or type. Inside means that each observation within a condition takes the same value or color or type, but different conditions have different values/color/type.</p>
<p>Let's look at what we have done above to help us compare:</p>
<ul>
<li><p><code>size</code> is called outside of the <code>aes()</code> and we assign it a specific value. As you can see from the Task 6 figure, each condition now has the same size of points. We could set this size to what we want, but keep it smallish: 3 or 5 are ok; 50 would be artistic, but not that informative. Had we set the size within <code>aes()</code>, something like <code>geom_point(aes(shape = Sex, size = Sex))</code> then both male and female would have different shapes AND different sizes. You can play around with this in your code to see how things work.</p></li>
<li><p>In contrast, we called <code>shape</code> inside the <code>aes()</code> and we set it based on a variable, <code>Sex</code>. Doing it this way ensures that each level of the <code>Sex</code> variable, male or female, get a different shape. Had we instead set <code>shape</code> outside the <code>aes()</code>, something like <code>geom_point(shape = 3, size = 3)</code> then all conditions would have the same shape and the same size. Different numbers relate to different shapes and different sizes. For example compare <code>shape = 3</code> to <code>shape = 13</code></p></li>
</ul>
<p>There are other arguments you could use: For example, if you wanted all points to have the same color, say red for example, then you could do <code>geom_point(color = "red")</code>. Remember to put the quotes around the color.</p>
<p>So hopefully this is starting to make sense and you can think about implementing it in your own figures. Note that arguments are separated by a comma. e.g. <code>geom_point(color = "red", size = 3, shape = 2)</code>.</p>
</div>
<div id="Ch3InClassQueT7" class="section level3" number="3.3.8">
<h3>
<span class="header-section-number">3.3.8</span> Task 7: Adding Labels and Changing the Background<a class="anchor" aria-label="anchor" href="#Ch3InClassQueT7"><i class="fas fa-link"></i></a>
</h3>
<p>This figure is looking really nice now. Let's finish it off by adding appropriate labels and editing the background. We introduced these to you in the previous section so hopefully you had a play with them to see how they work.</p>
<p>To change a label, we use the <code>labs()</code> function and it works like <code>labs(x = "Name", y = "Name", title = "Name")</code>.</p>
<ol style="list-style-type: decimal">
<li><p>Add this function to your code so that the y-axis indicates <code>Mean Reaction Time (ms)</code> and the x-axis indicates <code>Angle of Rotation (degrees)</code>. We haven't set a title here, but you can if you want some practice. Titles on Psychology figures are not common.</p></li>
<li><p>Set the figure as <code>theme_bw()</code> - this looks nice, but there are other options you might want to try which you can explore through <code>?theme</code> or the <a href="https://www.rstudio.com/wp-content/uploads/2015/03/ggplot2-cheatsheet.pdf" target="_blank">cheatsheet</a>.</p></li>
</ol>
<div class="webex-solution">
<button>
Helpful Hint
</button>
<div class="info">
<p>
<code>labs(x = "...", y = "...") + theme_bw()</code>
</p>
<p>
The key thing is to remember to <code><a href="https://rdrr.io/r/base/Arithmetic.html">+</a></code> the layer into the ggplot chain. And don't get this confused with pipes (%&gt;%).
</p>
<p>
<strong>Note:</strong> You add (+) layers to figures, and you pipe (%&gt;%) between functions.
</p>
</div>
</div>
</div>
<div id="Ch3InClassQueT8" class="section level3" number="3.3.9">
<h3>
<span class="header-section-number">3.3.9</span> Task 8: Separating a Variable and Removing Legends<a class="anchor" aria-label="anchor" href="#Ch3InClassQueT8"><i class="fas fa-link"></i></a>
</h3>
<p>Finally, we showed you two other functions that you could use to tidy up figures: <code>facet_wrap()</code> and <code>guides()</code>.</p>
<ul>
<li><p><code>facet_wrap()</code> is really effective for splitting up figures into panels based on a variable; it works like <code>facet_wrap(~variable)</code> where <code><a href="https://rdrr.io/r/base/tilde.html">~</a></code> can be read as <code>by</code>. So "split up the figure by variable", for example <code>Sex</code>. And if you had two variables to split the figure by, then: <code>facet_wrap(~variable1 + variable2)</code>.</p></li>
<li><p><code>guides()</code> is handy for turning legends on and off which might be taking up space. For instance, if you use a <code>facet_wrap()</code> to split the panels into Female and Male, do you really need the legend on the right saying Female and Male? You will normally have a guide for all the <code>color</code>, <code>shape</code>, <code>etc</code>, calls you have in your pipeline within your <code>aes()</code> calls. It works like <code>guide(call = FALSE)</code>.</p></li>
</ul>
<ol style="list-style-type: decimal">
<li><p>Add a <code>facet_wrap()</code> to have separate panels in your figure based on <code>Sex</code>.</p></li>
<li><p>Turn off all guides so that you do not have a legend in your figure.</p></li>
</ol>
<div class="webex-solution">
<button>
Helpful Hint
</button>
<div class="info">
<ol style="list-style-type: decimal">
<li>
<code>facet_wrap(~variable)</code>
</li>
<li>
<code>guides(group = FALSE, ???? = False, ....)</code>
</li>
</ol>
</div>
</div>
<p><br></p>
<p><span style="font-size: 22px; font-weight: bold; color: var(--pink);">Thinking Cap Point</span></p>
<p>If you have followed all the tasks correctly, then you should have the following figure:</p>
<pre><code>## `summarise()` has grouped output by 'Sex'. You can override using the `.groups` argument.</code></pre>
<pre><code>## Warning: `guides(&lt;scale&gt; = FALSE)` is deprecated. Please use `guides(&lt;scale&gt; =
## "none")` instead.</code></pre>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:Ch3InClassTask8-hidden"></span>
<img src="03-s01-lab03c_files/figure-html/Ch3InClassTask8-hidden-1.png" alt="The finished figure!" width="100%"><p class="caption">
Figure 3.11: The finished figure!
</p>
</div>
<p>Take a few minutes to look at the figure and try to interpret it in terms of reaction time as a function of rotation and sex. Try answering the following questions:</p>
<ul>
<li><p>In both sexes, mean reaction time <select class="webex-select"><option value="blank"></option>
<option value="">decreases with</option>
<option value="answer">increases with</option>
<option value="">is unaffected by</option></select> angle of rotation.</p></li>
<li><p>Angle of Rotation influences <select class="webex-select"><option value="blank"></option>
<option value="answer">female participants</option>
<option value="">male participants</option></select> more than <select class="webex-select"><option value="blank"></option>
<option value="">female participants</option>
<option value="answer">male participants</option></select></p></li>
</ul>
<div class="webex-solution">
<button>
Portfolio Point - Interpreting the results
</button>
<div class="info">
<p>
By looking at the figure, as angle of rotation increases (moving to the right of the x-axis), the mean reaction time increases (getting higher on the y-axis), indicating that participants take longer to respond the further the target image is rotated from the original. Also, as the male mean reaction times are quicker overall than the female mean reaction times, and the differences in reaction times between 0 degrees and 150 degrees is smaller in males, then you could perhaps say that males are affected less than females, or males perform the task quicker.
</p>
<p>
Keep in mind that we are only looking at correct responses here. As such, this figure would suggest the difference is not just male participants just responding quicker overall; instead it may suggest that males are responding correctly quicker overall.
</p>
<p>
Differences in mental rotation tasks have received much attention over the years and you should refer to the reference sections of the two main papers of this activity should you wish to follow the topic further.
</p>
</div>
</div>
</div>
<div id="final-considerations" class="section level3" number="3.3.10">
<h3>
<span class="header-section-number">3.3.10</span> Final Considerations<a class="anchor" aria-label="anchor" href="#final-considerations"><i class="fas fa-link"></i></a>
</h3>
<ol style="list-style-type: decimal">
<li>Many of the options we have seen in terms of <code>geom_point()</code> could have been applied to <code>geom_line()</code> to make alterations to the line. Try playing with these options. For example, the code line below would result in both sexes having a red line of equal size, but the style of line being different. Give it a shot!</li>
</ol>
<p><code>geom_line(aes(linetype = Sex), size = .5, color = "red")</code></p>
<ol start="2" style="list-style-type: decimal">
<li>Finally, if you look closely at the figure, you will see that the line between points actually goes in front of the points. It looks a bit messy. How could you make it tidier by having the line run behind the data points? Not sure? Remember that figures are constructed based on a series of layers. We draw one layer and then the next, so try changing Task 8 to draw the lines first and then the points on top. Give it a go!</li>
</ol>
<div class="sourceCode" id="cb103"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">ggplot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">menrot_facet_guide</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">Angle</span>, y <span class="op">=</span> <span class="va">mean_Resp</span>, group <span class="op">=</span> <span class="va">Sex</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu">geom_line</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_point</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>color <span class="op">=</span> <span class="va">Sex</span>, shape <span class="op">=</span> <span class="va">Sex</span><span class="op">)</span>, size <span class="op">=</span> <span class="fl">3</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">coord_cartesian</span><span class="op">(</span>ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">3500</span><span class="op">)</span>, expand <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">labs</span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Angel of Rotation (degrees)"</span>, y <span class="op">=</span> <span class="st">"Mean Reaction Time (ms)"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">facet_wrap</span><span class="op">(</span><span class="op">~</span><span class="va">Sex</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">guides</span><span class="op">(</span>group <span class="op">=</span> <span class="cn">FALSE</span>, color <span class="op">=</span> <span class="cn">FALSE</span>, shape <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">theme_bw</span><span class="op">(</span><span class="op">)</span></code></pre></div>
<p>In this chapter we have looked at working with layers and a variety of calls to shape, color, fills, etc, to create professional looking figures. Understanding figures through <code>ggplot</code> can seem like trial and error until you have a lot of experience. The beauty of it all is that once you have a figure you really like, you run the code and you get exactly the same figure again.</p>

</div>
</div>
<div id="Ch3PracticeSkills" class="section level2" number="3.4">
<h2>
<span class="header-section-number">3.4</span> Practice Your Skills<a class="anchor" aria-label="anchor" href="#Ch3PracticeSkills"><i class="fas fa-link"></i></a>
</h2>
<p>In order to complete these tasks you will need to download the data .csv files and the .Rmd file, which you need to edit, titled <code>Ch3_PracticeSkills_Visualisations.Rmd</code>. These can be downloaded within a zip file from the below link. Once downloaded and unzipped, you should create a new folder that you will use as your working directory; put the data files and the .Rmd file in that folder and set your working directory to that folder through the drop-down menus at the top. <a href="data/03-s01/Ch3_PracticeSkills_Visualisations.zip"><strong>Download the Exercises .zip file from here</strong></a>.</p>
<p>Now open the .Rmd file within RStudio. You will see there is a code chunk for each task. Follow the instructions on what to edit in each code chunk. This will often be entering code based on what we have covered up until this point.</p>
<p>Happy Data Visualising!</p>

</div>
<div id="solutions-to-questions-2" class="section level2" number="3.5">
<h2>
<span class="header-section-number">3.5</span> Solutions to Questions<a class="anchor" aria-label="anchor" href="#solutions-to-questions-2"><i class="fas fa-link"></i></a>
</h2>
<p>Below you will find the solutions to the questions for the Activities for this chapter. Only look at them after giving the questions a good try and speaking to the tutor about any issues.</p>
<div id="data-visualisation-application-1" class="section level3" number="3.5.1">
<h3>
<span class="header-section-number">3.5.1</span> Data Visualisation Application<a class="anchor" aria-label="anchor" href="#data-visualisation-application-1"><i class="fas fa-link"></i></a>
</h3>
<div id="task-1-1" class="section level4" number="3.5.1.1">
<h4>
<span class="header-section-number">3.5.1.1</span> Task 1<a class="anchor" aria-label="anchor" href="#task-1-1"><i class="fas fa-link"></i></a>
</h4>
<div class="sourceCode" id="cb104"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="st"><a href="https://tidyverse.tidyverse.org">"tidyverse"</a></span><span class="op">)</span>

<span class="va">menrot</span> <span class="op">&lt;-</span> <span class="fu">read_csv</span><span class="op">(</span><span class="st">"MentalRotationBehavioralData.csv"</span><span class="op">)</span>
<span class="va">demog</span> <span class="op">&lt;-</span> <span class="fu">read_csv</span><span class="op">(</span><span class="st">"demographics.csv"</span><span class="op">)</span></code></pre></div>
<p><a href="data-visualisation-through-ggplot2.html#Ch3InClassQueT1">Return to Task</a></p>
</div>
<div id="task-2-2" class="section level4" number="3.5.1.2">
<h4>
<span class="header-section-number">3.5.1.2</span> Task 2<a class="anchor" aria-label="anchor" href="#task-2-2"><i class="fas fa-link"></i></a>
</h4>
<div class="sourceCode" id="cb105"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">menrot_angle</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">menrot</span>, <span class="va">CorrectResponse</span> <span class="op">==</span> <span class="st">"Correct"</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">inner_join</span><span class="op">(</span><span class="va">demog</span>, <span class="st">"Participant"</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">group_by</span><span class="op">(</span><span class="va">Angle</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu">summarise</span><span class="op">(</span>mean_Resp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">Time</span><span class="op">)</span><span class="op">)</span>

<span class="fu">ggplot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">menrot_angle</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">Angle</span>, y <span class="op">=</span> <span class="va">mean_Resp</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu">geom_point</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_line</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">coord_cartesian</span><span class="op">(</span>ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">3500</span><span class="op">)</span>, expand <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></code></pre></div>
<ul>
<li>
<code>coord_cartesian()</code> is a function that can be used to show certain parts of a figure, controlling the visible X and Y axes. <code>expand = TRUE</code> adds a smaller buffer to the numbers you set. If you want to remove this buffer then set <code>expand = FALSE</code>.</li>
</ul>
<p><a href="data-visualisation-through-ggplot2.html#Ch3InClassQueT2">Return to Task</a></p>
</div>
<div id="task-3-2" class="section level4" number="3.5.1.3">
<h4>
<span class="header-section-number">3.5.1.3</span> Task 3<a class="anchor" aria-label="anchor" href="#task-3-2"><i class="fas fa-link"></i></a>
</h4>
<div class="sourceCode" id="cb106"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">menrot_angle_sex</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">menrot</span>, <span class="va">CorrectResponse</span> <span class="op">==</span> <span class="st">"Correct"</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">inner_join</span><span class="op">(</span><span class="va">demog</span>, <span class="st">"Participant"</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">group_by</span><span class="op">(</span><span class="va">Angle</span>, <span class="va">Sex</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu">summarise</span><span class="op">(</span>mean_Resp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">Time</span><span class="op">)</span><span class="op">)</span>

<span class="fu">ggplot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">menrot_angle_sex</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">Angle</span>, y <span class="op">=</span> <span class="va">mean_Resp</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu">geom_point</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_line</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">coord_cartesian</span><span class="op">(</span>ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">3500</span><span class="op">)</span>, expand <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></code></pre></div>
<p><a href="data-visualisation-through-ggplot2.html#Ch3InClassQueT3">Return to Task</a></p>
</div>
<div id="task-4-1" class="section level4" number="3.5.1.4">
<h4>
<span class="header-section-number">3.5.1.4</span> Task 4<a class="anchor" aria-label="anchor" href="#task-4-1"><i class="fas fa-link"></i></a>
</h4>
<div class="sourceCode" id="cb107"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">menrot_grouped</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">menrot</span>, <span class="va">CorrectResponse</span> <span class="op">==</span> <span class="st">"Correct"</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">inner_join</span><span class="op">(</span><span class="va">demog</span>, <span class="st">"Participant"</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">group_by</span><span class="op">(</span><span class="va">Angle</span>, <span class="va">Sex</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu">summarise</span><span class="op">(</span>mean_Resp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">Time</span><span class="op">)</span><span class="op">)</span>

<span class="fu">ggplot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">menrot_grouped</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">Angle</span>, y <span class="op">=</span> <span class="va">mean_Resp</span>, group <span class="op">=</span> <span class="va">Sex</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu">geom_point</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_line</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">coord_cartesian</span><span class="op">(</span>ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">3500</span><span class="op">)</span>, expand <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></code></pre></div>
<p><a href="data-visualisation-through-ggplot2.html#Ch3InClassQueT4">Return to Task</a></p>
</div>
<div id="task-5-1" class="section level4" number="3.5.1.5">
<h4>
<span class="header-section-number">3.5.1.5</span> Task 5<a class="anchor" aria-label="anchor" href="#task-5-1"><i class="fas fa-link"></i></a>
</h4>
<div class="sourceCode" id="cb108"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">menrot_grouped_color</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">menrot</span>, <span class="va">CorrectResponse</span> <span class="op">==</span> <span class="st">"Correct"</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">inner_join</span><span class="op">(</span><span class="va">demog</span>, <span class="st">"Participant"</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">group_by</span><span class="op">(</span><span class="va">Angle</span>, <span class="va">Sex</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu">summarise</span><span class="op">(</span>mean_Resp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">Time</span><span class="op">)</span><span class="op">)</span>

<span class="fu">ggplot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">menrot_grouped_color</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">Angle</span>, y <span class="op">=</span> <span class="va">mean_Resp</span>, group <span class="op">=</span> <span class="va">Sex</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu">geom_point</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>color <span class="op">=</span> <span class="va">Sex</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_line</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">coord_cartesian</span><span class="op">(</span>ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">3500</span><span class="op">)</span>, expand <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></code></pre></div>
<p><a href="data-visualisation-through-ggplot2.html#Ch3InClassQueT5">Return to Task</a></p>
</div>
<div id="task-6-1" class="section level4" number="3.5.1.6">
<h4>
<span class="header-section-number">3.5.1.6</span> Task 6<a class="anchor" aria-label="anchor" href="#task-6-1"><i class="fas fa-link"></i></a>
</h4>
<div class="sourceCode" id="cb109"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">menrot_shape_size</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">menrot</span>, <span class="va">CorrectResponse</span> <span class="op">==</span> <span class="st">"Correct"</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">inner_join</span><span class="op">(</span><span class="va">demog</span>, <span class="st">"Participant"</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">group_by</span><span class="op">(</span><span class="va">Angle</span>, <span class="va">Sex</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu">summarise</span><span class="op">(</span>mean_Resp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">Time</span><span class="op">)</span><span class="op">)</span>

<span class="fu">ggplot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">menrot_shape_size</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">Angle</span>, y <span class="op">=</span> <span class="va">mean_Resp</span>, group <span class="op">=</span> <span class="va">Sex</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu">geom_point</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>color <span class="op">=</span> <span class="va">Sex</span>, shape <span class="op">=</span> <span class="va">Sex</span><span class="op">)</span>, size <span class="op">=</span> <span class="fl">3</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_line</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">coord_cartesian</span><span class="op">(</span>ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">3500</span><span class="op">)</span>, expand <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></code></pre></div>
<p><a href="data-visualisation-through-ggplot2.html#Ch3InClassQueT6">Return to Task</a></p>
</div>
<div id="task-7-1" class="section level4" number="3.5.1.7">
<h4>
<span class="header-section-number">3.5.1.7</span> Task 7<a class="anchor" aria-label="anchor" href="#task-7-1"><i class="fas fa-link"></i></a>
</h4>
<div class="sourceCode" id="cb110"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">menrot_lab_theme</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">menrot</span>, <span class="va">CorrectResponse</span> <span class="op">==</span> <span class="st">"Correct"</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">inner_join</span><span class="op">(</span><span class="va">demog</span>, <span class="st">"Participant"</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">group_by</span><span class="op">(</span><span class="va">Angle</span>, <span class="va">Sex</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu">summarise</span><span class="op">(</span>mean_Resp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">Time</span><span class="op">)</span><span class="op">)</span>

<span class="fu">ggplot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">menrot_lab_theme</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">Angle</span>, y <span class="op">=</span> <span class="va">mean_Resp</span>, group <span class="op">=</span> <span class="va">Sex</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu">geom_point</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>color <span class="op">=</span> <span class="va">Sex</span>, shape <span class="op">=</span> <span class="va">Sex</span><span class="op">)</span>, size <span class="op">=</span> <span class="fl">3</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_line</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">coord_cartesian</span><span class="op">(</span>ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">3500</span><span class="op">)</span>, expand <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">labs</span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Angel of Rotation (degrees)"</span>, y <span class="op">=</span> <span class="st">"Mean Reaction Time (ms)"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">theme_bw</span><span class="op">(</span><span class="op">)</span></code></pre></div>
<p><a href="data-visualisation-through-ggplot2.html#Ch3InClassQueT7">Return to Task</a></p>
</div>
<div id="task-8-1" class="section level4" number="3.5.1.8">
<h4>
<span class="header-section-number">3.5.1.8</span> Task 8<a class="anchor" aria-label="anchor" href="#task-8-1"><i class="fas fa-link"></i></a>
</h4>
<div class="sourceCode" id="cb111"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">manrot_facet_guide</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">menrot</span>, <span class="va">CorrectResponse</span> <span class="op">==</span> <span class="st">"Correct"</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">inner_join</span><span class="op">(</span><span class="va">demog</span>, <span class="st">"Participant"</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">group_by</span><span class="op">(</span><span class="va">Angle</span>, <span class="va">Sex</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu">summarise</span><span class="op">(</span>mean_Resp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">Time</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>## `summarise()` has grouped output by 'Angle'. You can override using the `.groups` argument.</code></pre>
<div class="sourceCode" id="cb113"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">ggplot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">manrot_facet_guide</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">Angle</span>, y <span class="op">=</span> <span class="va">mean_Resp</span>, group <span class="op">=</span> <span class="va">Sex</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu">geom_point</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>color <span class="op">=</span> <span class="va">Sex</span>, shape <span class="op">=</span> <span class="va">Sex</span><span class="op">)</span>, size <span class="op">=</span> <span class="fl">3</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_line</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">coord_cartesian</span><span class="op">(</span>ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">3500</span><span class="op">)</span>, expand <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">labs</span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Angel of Rotation (degrees)"</span>, y <span class="op">=</span> <span class="st">"Mean Reaction Time (ms)"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">facet_wrap</span><span class="op">(</span><span class="op">~</span><span class="va">Sex</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">guides</span><span class="op">(</span>group <span class="op">=</span> <span class="cn">FALSE</span>, color <span class="op">=</span> <span class="cn">FALSE</span>, shape <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">theme_bw</span><span class="op">(</span><span class="op">)</span></code></pre></div>
<pre><code>## Warning: `guides(&lt;scale&gt; = FALSE)` is deprecated. Please use `guides(&lt;scale&gt; =
## "none")` instead.</code></pre>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:Ch3InClassSolT8-1"></span>
<img src="03-s01-lab03e_files/figure-html/Ch3InClassSolT8-1-1.png" alt="Task 8" width="100%"><p class="caption">
Figure 3.12: Task 8
</p>
</div>
<ul>
<li>Remembering it is a layer system, we could use the below code to have the lines behind the points.</li>
</ul>
<div class="sourceCode" id="cb115"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">manrot_facet_guide</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">menrot</span>, <span class="va">CorrectResponse</span> <span class="op">==</span> <span class="st">"Correct"</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">inner_join</span><span class="op">(</span><span class="va">demog</span>, <span class="st">"Participant"</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">group_by</span><span class="op">(</span><span class="va">Angle</span>, <span class="va">Sex</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu">summarise</span><span class="op">(</span>mean_Resp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">Time</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>## `summarise()` has grouped output by 'Angle'. You can override using the `.groups` argument.</code></pre>
<div class="sourceCode" id="cb117"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">ggplot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">manrot_facet_guide</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">Angle</span>, y <span class="op">=</span> <span class="va">mean_Resp</span>, group <span class="op">=</span> <span class="va">Sex</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu">geom_line</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_point</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>color <span class="op">=</span> <span class="va">Sex</span>, shape <span class="op">=</span> <span class="va">Sex</span><span class="op">)</span>, size <span class="op">=</span> <span class="fl">3</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">coord_cartesian</span><span class="op">(</span>ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">3500</span><span class="op">)</span>, expand <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">labs</span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Angel of Rotation (degrees)"</span>, y <span class="op">=</span> <span class="st">"Mean Reaction Time (ms)"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">facet_wrap</span><span class="op">(</span><span class="op">~</span><span class="va">Sex</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">guides</span><span class="op">(</span>group <span class="op">=</span> <span class="cn">FALSE</span>, color <span class="op">=</span> <span class="cn">FALSE</span>, shape <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">theme_bw</span><span class="op">(</span><span class="op">)</span></code></pre></div>
<pre><code>## Warning: `guides(&lt;scale&gt; = FALSE)` is deprecated. Please use `guides(&lt;scale&gt; =
## "none")` instead.</code></pre>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:Ch3InClassSolT8-2"></span>
<img src="03-s01-lab03e_files/figure-html/Ch3InClassSolT8-2-1.png" alt="Task 8 Alternative" width="100%"><p class="caption">
Figure 3.13: Task 8 Alternative
</p>
</div>
<p><a href="data-visualisation-through-ggplot2.html#Ch3InClassQueT8">Return to Task</a></p>
</div>
</div>
<div id="practice-your-skills-3" class="section level3" number="3.5.2">
<h3>
<span class="header-section-number">3.5.2</span> Practice Your Skills<a class="anchor" aria-label="anchor" href="#practice-your-skills-3"><i class="fas fa-link"></i></a>
</h3>
<p>Check your work against the solution to the tasks here: <a href="data/03-s01/Ch3_PracticeSkills_Visualisations_Solution.html"><strong>Chapter 3 Practice Your Skills Solution</strong></a>.</p>
<p><a href="data-visualisation-through-ggplot2.html#Ch3PracticeSkills">Return to Task</a></p>

</div>
</div>
<div id="additional-material" class="section level2" number="3.6">
<h2>
<span class="header-section-number">3.6</span> Additional Material<a class="anchor" aria-label="anchor" href="#additional-material"><i class="fas fa-link"></i></a>
</h2>
<p>Below is some additional material that might help you understand figures a bit more and how to present them in reports. Thus, if you want further clarification on the <code>aes()</code> call or want to know how to combine several plots into one, then read on!</p>
<div id="more-on-aes" class="section level3" number="3.6.1">
<h3>
<span class="header-section-number">3.6.1</span> More on <code>aes()</code><a class="anchor" aria-label="anchor" href="#more-on-aes"><i class="fas fa-link"></i></a>
</h3>
<p>In this chapter, we added a short note about using the <code>aes()</code> call, but we see people having issues with this so we thought a quick demonstration might help. Here is the code from the previous activity:</p>
<div class="sourceCode" id="cb119"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">menrot_angle_sex</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">menrot</span>, <span class="va">CorrectResponse</span> <span class="op">==</span> <span class="st">"Correct"</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">inner_join</span><span class="op">(</span><span class="va">demog</span>, <span class="st">"Participant"</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">group_by</span><span class="op">(</span><span class="va">Angle</span>, <span class="va">Sex</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu">summarise</span><span class="op">(</span>mean_Resp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">Time</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>## `summarise()` has grouped output by 'Angle'. You can override using the `.groups` argument.</code></pre>
<div class="sourceCode" id="cb121"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">ggplot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">menrot_angle_sex</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">Angle</span>, y <span class="op">=</span> <span class="va">mean_Resp</span>, group <span class="op">=</span> <span class="va">Sex</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu">geom_point</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>color <span class="op">=</span> <span class="va">Sex</span>, shape <span class="op">=</span> <span class="va">Sex</span><span class="op">)</span>, size <span class="op">=</span> <span class="fl">3</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_line</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">coord_cartesian</span><span class="op">(</span>ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">3500</span><span class="op">)</span>, expand <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">theme_gray</span><span class="op">(</span><span class="op">)</span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:Ch3InClassTask6-more-hidden"></span>
<img src="03-s01-lab03f_files/figure-html/Ch3InClassTask6-more-hidden-1.png" alt="Changing Shape and Size of Data Points" width="100%"><p class="caption">
Figure 3.14: Changing Shape and Size of Data Points
</p>
</div>
<p>Specifically, we are going to focus on the <code>geom_point()</code> line. Inside the <code>aes()</code> we stated <code>color = Sex, shape = Sex</code> and outside the <code>aes()</code> we stated, <code>size = 3</code>. Earlier we said, outside <code>aes()</code> means that all observations take the one value or color or type. Inside means that each observation within a condition takes the same value or color or type, but different conditions have different values/color/type. So based on that understanding, in the above plot, all shapes have the same size (i.e., 3), but there is a different shape and color of shape for each sex. Now let's demonstrate some alternatives.</p>
<ol style="list-style-type: decimal">
<li>All points have the same shape, color and size - nothing is in an <code>aes()</code>.
<ol style="list-style-type: lower-roman">
<li>here we need to state the color, shape and size we want all observations to have. We have chosen red for color (in quotes) shape style 3 (+) and size 6. We are not using a variable to split observations into groups.</li>
<li>we have changed the size to make the visualisation clearer</li>
</ol>
</li>
</ol>
<div class="sourceCode" id="cb122"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">ggplot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">menrot_angle_sex</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">Angle</span>, y <span class="op">=</span> <span class="va">mean_Resp</span>, group <span class="op">=</span> <span class="va">Sex</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu">geom_point</span><span class="op">(</span>color <span class="op">=</span> <span class="st">"red"</span>, shape <span class="op">=</span> <span class="fl">3</span>, size <span class="op">=</span> <span class="fl">6</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_line</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">coord_cartesian</span><span class="op">(</span>ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">3500</span><span class="op">)</span>, expand <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">theme_bw</span><span class="op">(</span><span class="op">)</span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:Ch3InClassTask6-more-hidden-11"></span>
<img src="03-s01-lab03f_files/figure-html/Ch3InClassTask6-more-hidden-11-1.png" alt="All points have the same shape, color and size" width="100%"><p class="caption">
Figure 3.15: All points have the same shape, color and size
</p>
</div>
<ol start="2" style="list-style-type: decimal">
<li>All points have the same shape and size, but color is determined by <code>Sex</code> (so goes inside the <code>aes()</code>).
<ol style="list-style-type: lower-roman">
<li>here we need to state the shape and size we want all dots to have. But this time we are giving the different levels within <code>Sex</code> (i.e., male and female) different colors - by putting that inside the <code>aes()</code>
</li>
</ol>
</li>
</ol>
<div class="sourceCode" id="cb123"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">ggplot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">menrot_angle_sex</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">Angle</span>, y <span class="op">=</span> <span class="va">mean_Resp</span>, group <span class="op">=</span> <span class="va">Sex</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu">geom_point</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>color <span class="op">=</span> <span class="va">Sex</span><span class="op">)</span>, shape <span class="op">=</span> <span class="fl">3</span>, size <span class="op">=</span> <span class="fl">6</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_line</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">coord_cartesian</span><span class="op">(</span>ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">3500</span><span class="op">)</span>, expand <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">theme_bw</span><span class="op">(</span><span class="op">)</span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:Ch3InClassTask6-more-hidden-12"></span>
<img src="03-s01-lab03f_files/figure-html/Ch3InClassTask6-more-hidden-12-1.png" alt="All points have the same shape and size but color is determined by Sex" width="100%"><p class="caption">
Figure 3.16: All points have the same shape and size but color is determined by Sex
</p>
</div>
<ol start="3" style="list-style-type: decimal">
<li>We showed the code for setting color and shape by <code>Sex</code> previously. Instead now we will set the color, shape and size by the variable <code>Sex</code>.
<ol style="list-style-type: lower-roman">
<li>here as all options are in the <code>aes()</code> we will have different colors, sizes, and shapes between males and females, but all males will have the same color, size and shape, and all females will have the same color size and shape.</li>
</ol>
</li>
</ol>
<div class="sourceCode" id="cb124"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">ggplot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">menrot_angle_sex</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">Angle</span>, y <span class="op">=</span> <span class="va">mean_Resp</span>, group <span class="op">=</span> <span class="va">Sex</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu">geom_point</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>color <span class="op">=</span> <span class="va">Sex</span>, shape <span class="op">=</span> <span class="va">Sex</span>, size <span class="op">=</span> <span class="va">Sex</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_line</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">coord_cartesian</span><span class="op">(</span>ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">3500</span><span class="op">)</span>, expand <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">theme_bw</span><span class="op">(</span><span class="op">)</span></code></pre></div>
<pre><code>## Warning: Using size for a discrete variable is not advised.</code></pre>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:Ch3InClassTask6-more-hidden-13"></span>
<img src="03-s01-lab03f_files/figure-html/Ch3InClassTask6-more-hidden-13-1.png" alt="All points have the same shape and size but color is determined by Sex" width="100%"><p class="caption">
Figure 3.17: All points have the same shape and size but color is determined by Sex
</p>
</div>
<p>You actually get a warning when doing this option. Why? Because if you had numerous options then you would have too many different shapes being created and it would cause issues with the code and may even crash it. Pay attention to warnings.</p>
<p>And the reason you have to decide what is the best approach for displaying your data is because if all observations within a condition are the same, then showing them as all different colors and shapes makes very little sense. You always need to think about what you are trying to convey. Look at these two figures and think about which one is easier to understand that all observations are from the same condition. The one on the left! The one on the right suggests there is something different about all the observations.</p>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:comb6-more-hidden-2"></span>
<img src="03-s01-lab03f_files/figure-html/comb6-more-hidden-2-1.png" alt="The plot on the left suggests all observations are of the same condition. The figure on the right suggests a difference between all observations. Always think about what your information you convey in your figures!" width="100%"><p class="caption">
Figure 3.18: The plot on the left suggests all observations are of the same condition. The figure on the right suggests a difference between all observations. Always think about what your information you convey in your figures!
</p>
</div>
<p>Hopefully that is beginning to become clearer. Insider the <code>aes()</code> means that all observations within a variable/condition are shown the same, but are different from observations from a different variable/condition. Outside the <code>aes()</code> means that all observations are shown as the same regardless of condition.</p>
</div>
<div id="combining-plots-into-one-figure" class="section level3" number="3.6.2">
<h3>
<span class="header-section-number">3.6.2</span> Combining Plots into one Figure<a class="anchor" aria-label="anchor" href="#combining-plots-into-one-figure"><i class="fas fa-link"></i></a>
</h3>
<p>Space within a report is a commodity. Figures can be incredibly useful in getting information across in a very efficient manner, but when you have a strict word count, having multiple figures can really chew into the limit, given that each figure needs a legend and each legend counts. One way to get around this is to merge figures together into one big figure that perhaps convey similar or related information. We are going to show you how to do that using a package called <code>patchwork</code>.</p>
<div class="danger">
<p>
<code>patchwork</code> is unlikely to be on our lab machines so please only try this on your own machine. If you haven't previously installed the <code>patchwork</code> package on your own machine before, you will have to install it first, e.g. <code><a href="https://rdrr.io/r/utils/install.packages.html">install.packages("patchwork")</a></code>.
</p>
</div>
<p><br></p>
<p>Plots like boxplots and histograms, when combined, can be incredibly useful in understanding the overall shape of your data and whether or not it fits the assumptions of inferential tests, something we will come on to later. If we were to create two separate plots, we might get something like this:</p>
<div class="sourceCode" id="cb126"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">menrot_hist_correct</span> <span class="op">&lt;-</span> <span class="fu">group_by</span><span class="op">(</span><span class="va">menrot</span>, <span class="va">Participant</span>, <span class="va">CorrectResponse</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu">summarise</span><span class="op">(</span>Mean_Time <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">Time</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">CorrectResponse</span> <span class="op">==</span> <span class="st">"Correct"</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">inner_join</span><span class="op">(</span><span class="va">demog</span>, <span class="st">"Participant"</span><span class="op">)</span>

<span class="fu">ggplot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">menrot_hist_correct</span>, 
       <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">Mean_Time</span>,
           fill <span class="op">=</span> <span class="va">Sex</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu">geom_histogram</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">theme_bw</span><span class="op">(</span><span class="op">)</span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:ch3-add-1"></span>
<img src="03-s01-lab03f_files/figure-html/ch3-add-1-1.png" alt="A histogram of distribution of Mean Time counts by Sex" width="100%"><p class="caption">
Figure 3.19: A histogram of distribution of Mean Time counts by Sex
</p>
</div>
<p><br></p>
<p>And:</p>
<div class="sourceCode" id="cb127"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">menrot_box_correct</span> <span class="op">&lt;-</span> <span class="fu">group_by</span><span class="op">(</span><span class="va">menrot</span>, <span class="va">Participant</span>, <span class="va">CorrectResponse</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu">summarise</span><span class="op">(</span>Mean_Time <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">Time</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">CorrectResponse</span> <span class="op">==</span> <span class="st">"Correct"</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">inner_join</span><span class="op">(</span><span class="va">demog</span>, <span class="st">"Participant"</span><span class="op">)</span></code></pre></div>
<pre><code>## `summarise()` has grouped output by 'Participant'. You can override using the `.groups` argument.</code></pre>
<div class="sourceCode" id="cb129"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">ggplot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">menrot_box_correct</span>, 
       <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">CorrectResponse</span>, 
           y <span class="op">=</span> <span class="va">Mean_Time</span>, 
           fill <span class="op">=</span> <span class="va">Sex</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu">geom_boxplot</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">theme_bw</span><span class="op">(</span><span class="op">)</span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:ch3-add-2"></span>
<img src="03-s01-lab03f_files/figure-html/ch3-add-2-1.png" alt="A boxplot of the spreads of Mean Time for Correct Responses by Sex" width="100%"><p class="caption">
Figure 3.20: A boxplot of the spreads of Mean Time for Correct Responses by Sex
</p>
</div>
<p><br></p>
<p>Now given that they both divide the data by sex, you can start to see how the figure legend for each plot becomes a bit repetitive, and how combining them into one figure would potentially make things easier. There are a number of packages to do this, but <code>patchwork</code> is very straightforward and flexible.</p>
<p>Let's now call in <code>patchwork</code></p>
<div class="sourceCode" id="cb130"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://patchwork.data-imaginist.com">patchwork</a></span><span class="op">)</span></code></pre></div>
<p>The first thing you need to do when using patchwork is save your plots in an object (just like you would with the output of any function). Using the code above, this might look like below for the boxplot:</p>
<div class="sourceCode" id="cb131"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">p_box</span> <span class="op">&lt;-</span> <span class="fu">ggplot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">menrot_box_correct</span>, 
       <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">CorrectResponse</span>, 
           y <span class="op">=</span> <span class="va">Mean_Time</span>, 
           fill <span class="op">=</span> <span class="va">Sex</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu">geom_boxplot</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">labs</span><span class="op">(</span>title <span class="op">=</span> <span class="st">"A"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">theme_bw</span><span class="op">(</span><span class="op">)</span></code></pre></div>
<p>And below for the histogram:</p>
<div class="sourceCode" id="cb132"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">p_hist</span> <span class="op">&lt;-</span> <span class="fu">ggplot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">menrot_hist_correct</span>, 
       <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">Mean_Time</span>,
           fill <span class="op">=</span> <span class="va">Sex</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu">geom_histogram</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">labs</span><span class="op">(</span>title <span class="op">=</span> <span class="st">"B"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">theme_bw</span><span class="op">(</span><span class="op">)</span></code></pre></div>
<p><br></p>
<p><strong>Note:</strong> The reason for the inclusion of a title on each plot will become clear in a second.</p>
<p><strong>Note:</strong> When you run these codes no plots will be generated as you are saving them as objects - the boxplot in <code>p_box</code> and the histogram in <code>p_hist</code>. It is important to realise this distinction as if someone asks you to make produce a code where the figure is generated when your code knits, and you have saved your plot as an object, then your figure might not show. If you have save a plot as an object, you can generate the figure by just calling the name of the object. If you look at the ggplot cheatsheet you will see this approach a lot. Here is how we would call the boxplot stored in <code>p_box</code>.</p>
<div class="sourceCode" id="cb133"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">p_box</span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:p-box"></span>
<img src="03-s01-lab03f_files/figure-html/p-box-1.png" alt="A boxplot of the spreads of Mean Time for Correct Responses by Sex" width="100%"><p class="caption">
Figure 3.21: A boxplot of the spreads of Mean Time for Correct Responses by Sex
</p>
</div>
<div class="sourceCode" id="cb134"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">p_hist</span></code></pre></div>
<pre><code>## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:p-hist"></span>
<img src="03-s01-lab03f_files/figure-html/p-hist-1.png" alt="A histogram of distribution of Mean Time counts by Sex" width="100%"><p class="caption">
Figure 3.22: A histogram of distribution of Mean Time counts by Sex
</p>
</div>
<p><br></p>
<p><strong>Note:</strong> You will see a warning from the histogram plot about selecting a binwidth. We haven't really looked at this yet but will do in due course. If you wanted to "fix" that warning then changing the histrogram code to something like <code>+ geom_histogram(binwidth = 100)</code> might work. The value that you enter is relative to the scale of your data. A binwidth of 1 would create a bin every increase of 1 ms. A binwidth of 100 creates a bin every 100 ms.</p>
<p>So far so nothing exciting. Looks just like what we have seen before. Didn't we say we wanted both the plots in a single figure, right? Well to do that in patchwork, we simply "add" the plots together using a plus sign (+), as such:</p>
<div class="sourceCode" id="cb136"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">p_box</span> <span class="op">+</span> <span class="va">p_hist</span></code></pre></div>
<pre><code>## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:comb1"></span>
<img src="03-s01-lab03f_files/figure-html/comb1-1.png" alt="A boxplot (A - left) of the spreads of Mean Time for Correct Responses, and histogram (B - right) of distribution of Mean Time counts, both separated by Sex (female - red, male - cyan)" width="100%"><p class="caption">
Figure 3.23: A boxplot (A - left) of the spreads of Mean Time for Correct Responses, and histogram (B - right) of distribution of Mean Time counts, both separated by Sex (female - red, male - cyan)
</p>
</div>
<p><strong>Note:</strong> We can use the "titles"" we added to the plots in the original code above to tell readers which plot, within the combined figure, we are referring to, A or B, left or right, as shown in the figure legend beneath the figure. This might seem a bit pedantic, but you have no control over how somebody views your published figure, and as such clarity is paramount!</p>
<p>Awesome, that it? No! We can also change the configuration of the plots in the combined figure. Say we wanted the plots on top of each other - portrait rather than landscape - well in that instance we divide the plots using the divide sign (/), as such:</p>
<div class="sourceCode" id="cb138"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">p_box</span> <span class="op">/</span> <span class="va">p_hist</span></code></pre></div>
<pre><code>## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:comb2"></span>
<img src="03-s01-lab03f_files/figure-html/comb2-1.png" alt="A boxplot (A - top) of the spreads of Mean Time for Correct Responses, and histogram (B - bottom) of distribution of Mean Time counts, both separated by Sex (female - red, male - cyan)" width="100%"><p class="caption">
Figure 3.24: A boxplot (A - top) of the spreads of Mean Time for Correct Responses, and histogram (B - bottom) of distribution of Mean Time counts, both separated by Sex (female - red, male - cyan)
</p>
</div>
<p>And now we refer to top and bottom, rather than left and right. In fact, <code>patchwork</code> is really flexible and can work with multiple plots and arrangements. Hypothetically, say you had three plots and wanted two on top of one, then you would use the approach of combining "+" and "/" as such:</p>
<div class="sourceCode" id="cb140"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="op">(</span><span class="va">plot1</span> <span class="op">+</span> <span class="va">plot2</span><span class="op">)</span><span class="op">/</span><span class="va">plot3</span></code></pre></div>
<p>Remember the trick to using patchwork is to save your plots as objects first (<code>p1 &lt;- ggplot(....)</code>) and the rest is easy. But be sure to always know if your figure is to be shown when knitted or not; more often than not, seeing the figure is more important than seeing the code.</p>
<p><strong>Happy Visualising!</strong></p>
<p><span style="font-size: 22px; font-weight: bold; color: var(--purple);">End of Additional Material!</span></p>

</div>
</div>
</div>
<script>

/* update total correct if #webex-total_correct exists */
update_total_correct = function() {
  console.log("webex: update total_correct");

  if (t = document.getElementById("webex-total_correct")) {
    var correct = document.getElementsByClassName("webex-correct").length;
    var solvemes = document.getElementsByClassName("webex-solveme").length;
    var radiogroups = document.getElementsByClassName("webex-radiogroup").length;
    var selects = document.getElementsByClassName("webex-select").length;
    
    t.innerHTML = correct + " of " + (solvemes + radiogroups + selects) + " correct";
  }
}

/* webex-solution button toggling function */
b_func = function() {
  console.log("webex: toggle hide");
  
  var cl = this.parentElement.classList;
  if (cl.contains('open')) {
    cl.remove("open");
  } else {
    cl.add("open");
  }
}

/* function for checking solveme answers */
solveme_func = function(e) {
  console.log("webex: check solveme");

  var real_answers = JSON.parse(this.dataset.answer);
  var my_answer = this.value;
  var cl = this.classList;
  if (cl.contains("ignorecase")) {
    my_answer = my_answer.toLowerCase();
  }
  if (cl.contains("nospaces")) {
    my_answer = my_answer.replace(/ /g, "")
  }

  if (my_answer == "") {
    cl.remove("webex-correct");
    cl.remove("webex-incorrect");
  } else if (real_answers.includes(my_answer)) {
    cl.add("webex-correct");
    cl.remove("webex-incorrect");
  } else {
    cl.add("webex-incorrect");
    cl.remove("webex-correct");
  }

  // match numeric answers within a specified tolerance
  if(this.dataset.tol > 0){
    var tol = JSON.parse(this.dataset.tol);
    var matches = real_answers.map(x => Math.abs(x - my_answer) < tol)
    if (matches.reduce((a, b) => a + b, 0) > 0) {
      cl.add("webex-correct");
    } else {
      cl.remove("webex-correct");
    }
  }

  // added regex bit
  if (cl.contains("regex")){
    answer_regex = RegExp(real_answers.join("|"))
    if (answer_regex.test(my_answer)) {
      cl.add("webex-correct");
    }
  }

  update_total_correct();
}

/* function for checking select answers */
select_func = function(e) {
  console.log("webex: check select");
  
  var cl = this.classList
  
  /* add style */
  cl.remove("webex-incorrect");
  cl.remove("webex-correct");
  if (this.value == "answer") {
    cl.add("webex-correct");
  } else if (this.value != "blank") {
    cl.add("webex-incorrect");
  }
  
  update_total_correct();
}

/* function for checking radiogroups answers */
radiogroups_func = function(e) {
  console.log("webex: check radiogroups");

  var checked_button = document.querySelector('input[name=' + this.id + ']:checked');
  var cl = checked_button.parentElement.classList;
  var labels = checked_button.parentElement.parentElement.children;
  
  /* get rid of styles */
  for (i = 0; i < labels.length; i++) {
    labels[i].classList.remove("webex-incorrect");
    labels[i].classList.remove("webex-correct");
  }
  
  /* add style */
  if (checked_button.value == "answer") {
    cl.add("webex-correct");
  } else {
    cl.add("webex-incorrect");
  }
  
  update_total_correct();
}

window.onload = function() {
  console.log("onload");
  /* set up solution buttons */
  var buttons = document.getElementsByTagName("button");

  for (var i = 0; i < buttons.length; i++) {
    if (buttons[i].parentElement.classList.contains('webex-solution')) {
      buttons[i].onclick = b_func;
    }
  }

  /* set up webex-solveme inputs */
  var solveme = document.getElementsByClassName("webex-solveme");

  for (var i = 0; i < solveme.length; i++) {
    /* make sure input boxes don't auto-anything */
    solveme[i].setAttribute("autocomplete","off");
    solveme[i].setAttribute("autocorrect", "off");
    solveme[i].setAttribute("autocapitalize", "off");
    solveme[i].setAttribute("spellcheck", "false");
    solveme[i].value = "";

    /* adjust answer for ignorecase or nospaces */
    var cl = solveme[i].classList;
    var real_answer = solveme[i].dataset.answer;
    if (cl.contains("ignorecase")) {
      real_answer = real_answer.toLowerCase();
    }
    if (cl.contains("nospaces")) {
      real_answer = real_answer.replace(/ /g, "");
    }
    solveme[i].dataset.answer = real_answer;

    /* attach checking function */
    solveme[i].onkeyup = solveme_func;
    solveme[i].onchange = solveme_func;
  }
  
  /* set up radiogroups */
  var radiogroups = document.getElementsByClassName("webex-radiogroup");
  for (var i = 0; i < radiogroups.length; i++) {
    radiogroups[i].onchange = radiogroups_func;
  }
  
  /* set up selects */
  var selects = document.getElementsByClassName("webex-select");
  for (var i = 0; i < selects.length; i++) {
    selects[i].onchange = select_func;
  }

  update_total_correct();
}

</script><script>
$( document ).ready(function() {
  var cite = ' ';
  var psyteachr = ' <a href="https://psyteachr.github.io/"><img src="images/logos/psyteachr_logo.png" style="height: 31px; color: white;" alt="psyTeachR: Reproducible Research" /></a>';
  var license = ' <a rel="license" href="https://creativecommons.org/licenses/by-sa/4.0/" target="blank"><img alt="Creative Commons License" style="border-width:0" src="https://i.creativecommons.org/l/by-sa/4.0/88x31.png"></a>';

  $("footer div.row div:eq(1) p").html(
    psyteachr + license + cite
  );
  
  // open rdrr links externally
  $("a[href^='https://rdrr.io']").click(function(){
    window.open(this.href);
    return false;
  });
  
  // visible second sidebar in mobile
  function move_sidebar() {
    var w = window.innerWidth;
    if (w < 992) {
      $("#toc").appendTo($("#main-nav"));
    } else {
      $("#toc").appendTo($("div.sidebar-chapter"));
    }
  }
  move_sidebar();
  window.onresize = move_sidebar;
});
</script><div class="chapter-nav">
<div class="prev"><a href="data-wrangling-a-key-skill.html"><span class="header-section-number">2</span> Data-Wrangling: A Key Skill</a></div>
<div class="next"><a href="revisiting-probability-distributions.html"><span class="header-section-number">4</span> Revisiting Probability Distributions</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#data-visualisation-through-ggplot2"><span class="header-section-number">3</span> Data Visualisation Through ggplot2</a></li>
<li><a class="nav-link" href="#overview-3"><span class="header-section-number">3.1</span> Overview</a></li>
<li>
<a class="nav-link" href="#data-visualisation-basics"><span class="header-section-number">3.2</span> Data Visualisation Basics</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#introducing-the-data-set-mental-rotation-ability"><span class="header-section-number">3.2.1</span> Introducing the Data Set: Mental Rotation Ability</a></li>
<li><a class="nav-link" href="#basic-structure-of-ggplot"><span class="header-section-number">3.2.2</span> Basic Structure of ggplot()</a></li>
<li><a class="nav-link" href="#scatterplots---geom_point"><span class="header-section-number">3.2.3</span> Scatterplots - geom_point()</a></li>
<li><a class="nav-link" href="#histograms---geom_histogram"><span class="header-section-number">3.2.4</span> Histograms - geom_histogram()</a></li>
<li><a class="nav-link" href="#boxplots---geom_boxplot"><span class="header-section-number">3.2.5</span> Boxplots - geom_boxplot()</a></li>
<li><a class="nav-link" href="#barplots---geom_bar-or-geom_col"><span class="header-section-number">3.2.6</span> Barplots - geom_bar() or geom_col()</a></li>
<li><a class="nav-link" href="#themes-labels-guides-and-facet_wraps"><span class="header-section-number">3.2.7</span> Themes, Labels, Guides, and facet_wraps()</a></li>
<li><a class="nav-link" href="#choosing-appropriate-figures"><span class="header-section-number">3.2.8</span> Choosing Appropriate Figures</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#data-visualisation-application"><span class="header-section-number">3.3</span> Data Visualisation Application</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#mental-rotation-angle-and-reaction-time"><span class="header-section-number">3.3.1</span> Mental Rotation: Angle and Reaction Time</a></li>
<li><a class="nav-link" href="#Ch3InClassQueT1"><span class="header-section-number">3.3.2</span> Task 1: Loading and Viewing the Data</a></li>
<li><a class="nav-link" href="#Ch3InClassQueT2"><span class="header-section-number">3.3.3</span> Task 2: Recreating the Figure</a></li>
<li><a class="nav-link" href="#Ch3InClassQueT3"><span class="header-section-number">3.3.4</span> Task 3: Examining Additional Variable Effects</a></li>
<li><a class="nav-link" href="#Ch3InClassQueT4"><span class="header-section-number">3.3.5</span> Task 4: Grouping the Figure Data</a></li>
<li><a class="nav-link" href="#Ch3InClassQueT5"><span class="header-section-number">3.3.6</span> Task 5: Identifying Groups Using aes()</a></li>
<li><a class="nav-link" href="#Ch3InClassQueT6"><span class="header-section-number">3.3.7</span> Task 6: Changing the Shape and Size of Data Points</a></li>
<li><a class="nav-link" href="#Ch3InClassQueT7"><span class="header-section-number">3.3.8</span> Task 7: Adding Labels and Changing the Background</a></li>
<li><a class="nav-link" href="#Ch3InClassQueT8"><span class="header-section-number">3.3.9</span> Task 8: Separating a Variable and Removing Legends</a></li>
<li><a class="nav-link" href="#final-considerations"><span class="header-section-number">3.3.10</span> Final Considerations</a></li>
</ul>
</li>
<li><a class="nav-link" href="#Ch3PracticeSkills"><span class="header-section-number">3.4</span> Practice Your Skills</a></li>
<li>
<a class="nav-link" href="#solutions-to-questions-2"><span class="header-section-number">3.5</span> Solutions to Questions</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#data-visualisation-application-1"><span class="header-section-number">3.5.1</span> Data Visualisation Application</a></li>
<li><a class="nav-link" href="#practice-your-skills-3"><span class="header-section-number">3.5.2</span> Practice Your Skills</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#additional-material"><span class="header-section-number">3.6</span> Additional Material</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#more-on-aes"><span class="header-section-number">3.6.1</span> More on aes()</a></li>
<li><a class="nav-link" href="#combining-plots-into-one-figure"><span class="header-section-number">3.6.2</span> Combining Plots into one Figure</a></li>
</ul>
</li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
<li><a id="book-source" href="https://github.com/psyteachr/analysis-v2/blob/master/book/03-s01-lab03a.Rmd">View source <i class="fab fa-github"></i></a></li>
          <li><a id="book-edit" href="https://github.com/psyteachr/analysis-v2/edit/master/book/03-s01-lab03a.Rmd">Edit this page <i class="fab fa-github"></i></a></li>
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>Analysis</strong>" was written by Phil McAleer, Carolina E. Kuepper-Tetzel, Helena Paterson. It was last built on 2022-01-29.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script><script type="text/x-mathjax-config">const popovers = document.querySelectorAll('a.footnote-ref[data-toggle="popover"]');
for (let popover of popovers) {
  const div = document.createElement('div');
  div.setAttribute('style', 'position: absolute; top: 0, left:0; width:0, height:0, overflow: hidden; visibility: hidden;');
  div.innerHTML = popover.getAttribute('data-content');

  var has_math = div.querySelector("span.math");
  if (has_math) {
    document.body.appendChild(div);
    MathJax.Hub.Queue(["Typeset", MathJax.Hub, div]);
    MathJax.Hub.Queue(function() {
      popover.setAttribute('data-content', div.innerHTML);
      document.body.removeChild(div);
    })
  }
}
</script>
</body>
</html>
